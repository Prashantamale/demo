select * from salespeople
select * from customerss
select * from orders1

--1.  List all customers with a rating of 100.

Select * from Customerss where rating=100;
------------------------------------------------------------------------------------
--2.  Find all records in the Customer table with NULL values in the city column.

Select * from Customers Where city is null
------------------------------------------------------------------------------------
--3.  Find the largest order taken by each salesperson on each date.
select max(amt),snum,odate from orders1
group by snum,odate
g

select * from orders1
select distinct snum,odate,max(amt) from orders1
group by (snum,odate)

-------------------------------------------------------------------------------
--4.  Arrange the Orders table by descending customer number.
select * from orders1
order by cnum desc
Select * from Orders order by cnum desc;
------------------------------------------------------------------------------------
--5.  Find which salespeople currently have orders in the Orders table.
select distinct(s.snum),s.sname from salespeople s,orders1 o where s.snum=o.snum
select * from salespeople


Select distinct(s.snum),s.* from Salespeople s, Orders o where s.snum=o.snum ;
 
select distinct(s.snum),s.* from salespeople s, orders1 o where s.snum = o.snum
Select * from Salespeople s, Orders1 o where s.snum=o.snum ;
----------------------------------------------------------------------------------
--6.  List names of all customers matched with the salespeople serving them.
select c.cname,s.sname from customerss c, salespeople s
where c.snum = s.snum

Select * from Salespeople s, Customerss c where s.snum=c.snum ;
select * from salespeople, Customers where salespeople.snum=Customers.snum
-----------------------------------------------------------------------------------
--7.  Find the names and numbers of all salespeople who had more than one customer.
select s.sname,s.snum,count(c.cnum)from salespeople s,customerss c
where s.snum =c.snum
group by s.sname,s.snum
having count(c.cnum)>1

select s.sname,s.snum,count(c.cnum) from salespeople s,customers c
where s.snum=c.snum
group by (s.sname,s.snum)
having count(cnum)>1
 
------------------------------------------------------------------------------------.
--8.  Count the orders of each of the salespeople and output the results in descending order.

select count(onum),snum from orders1
group by snum
order by count(onum)desc

select count(onum),snum from orders
Group by Snum 
order by count(onum) desc
----------------------------------------------------------------------------------

--9.  List the Customer table if and only if one or more of the customers in the Customer
-- tables are located in San Jose.
select * from customerss
where city ='san jose'
select * from customers where city = 'San Jose' or city= 'san Jose'
------------------------------------------------------------------------------------

--10. Match salespeople to customers according to what city they lived in.
select s.*,c.* from customerss c, salespeople s
where c.city = c.city
select s.sname,c.cname,c.city from salespeople s, customers c
where s.city=c.city
------------------------------------------------------
--11. Find the largest order taken by each salesperson.
select max(amt),snum from orders1
group by snum


--------
--12. Find customers in San Jose who has a rating above 200.

select * from orders where city='san Jose' and rating > 200
----------------------------------------------------------------------------------

--13. List the names and commissions of all salespeople in London.
select Sname,Comm,city from salespeople where city='London'
---------------------------------------------------------------------------------
--14. List all the orders of salesperson Monika from the Orders table.
select s.sname,o.* from salespeople s,orders1 o
where s.snum = o.snum
and sname = 'monika'


select * from salespeople
select onum,s.snum from orders o , salespeople s
where o.snum=s.snum and s.sname = 'Monika'
---------------------------------------------------------------------------------
--15. Find all customers with orders on October 3.
select c.*,o.* from customerss c,orders1 o where c.cnum= o.cnum
and odate ='03-oct-1996'
select Cnum from orders 
where to_char(odate,'dd-mm')='03-10'
------------------------------------------------------------------
--16. Give the sums of the amounts from the orders table, grouped by date, 
select sum(amt),odate from orders1
group by odate
select * from orders
Select Sum(Amt), Odate from orders
group by Odate
-----------------------------------------------------------------------
--17. Eliminating all those dates where the SUM was not at least 2000.00 above 
--the MAX amount.
select * from orders1
select sum(amt),odate from orders1
group by odate
having sum(amt)>2000

--18. Select all orders that had amounts that were greater than at least one of the orders 
--from October 6.
select * from orders1 
where amt>(select avg(amt)from orders1 where odate ='06-oct-1996')

--19. Write a query that uses the EXISTS operator to extract all salespeople who have
-- customers with a rating of 300.
select * from salespeople
where exists  (select snum from customerss where rating = '300')

XX
--20. Find all pairs of customers having the same rating.
select * from customerss
group by rating,snum

select cnum,cname,city,rating,snum,
dense_rank()over(partition by rating order by snum)rn from customerss


--21. Find all customers with CNUM, 1000 above the SNUM of Serres.
select c.*,s.snum from customerss c,salespeople s
where c.snum = s.snum
and c.cnum>(select s.snum+1000 from salespeople where s.sname = 'serres')

select snum+1000 from salespeople where sname = 'serres'

select C.* from customerss c, salespeople s
where c.snum=s.snum and cnum>(s.snum+1000) and sname='serres'

--22. Give the salespeople’s commissions as percentage instead of decimal numbers.
select * from salespeople
select snum,sname,city, concat(comm*100,'%') from salespeople

--23. Find the largest order taken by each salesperson on each date, 
--eliminating those MAX orders, which are less than $3000.00 in value.
select max(amt),snum,odate from orders1
group by snum,odate
having max(amt)>3000
--24. List the largest orders on October 3, for each salesperson.
select max(amt),odate,snum from orders1
group by odate,snum
having odate = '03-oct-1996'

select * from orders
select snum, Max(amt),odate from orders
where to_char(odate,'dd-mm')='03-10'
group by snum,odate
------------------------------------------------------------------------------
--25. Find all customers located in cities where Serres (SNUM 1002) has customers.
select c.*,s.sname from customerss c,salespeople s
where c.snum = s.snum
and c.city in(select city from salespeople where sname = 'serres')


--26. Select all customers with a rating above 200.00.
select * from customerss where rating>200
select * from customers where rating>200.00
----------------------------------------------------------------------------------
--27. Count the number of salespeople currently listing orders in the Orders table.
select count(onum),snum from orders1
group by snum

select * from orders1
Select Count(snum) from orders
-------------------------------------------------------------------------
--28. Write a query that produces all customers serviced by salespeople with a commission
-- above 12%. Output the customer’s name and the salesperson‘s rate of commission.
select * from customerss
where snum in(select snum from salespeople where comm>0.12 )

select c.cname,s.sname, s.comm from customerss c,salespeople s
where c.snum =s.snum
and s.comm>0.12
order by cname


--29. Find salespeople who have multiple customers.
select count(cnum),snum from customerss
group by snum
having count(cnum)>1

select snum, Count(cnum) from orders
group by snum
having Count(cnum)>1
---------------------------------------------------------------------------
--30. Find salespeople with customers located in their city.
select c.cname,c.city,s.sname,s.city from salespeople s,customerss c
where s.city=c.city


--31. Find all salespeople whose name starts with ‘P’ and the fourth character is ‘I’.
select * from salespeople where sname like 'p__i%'
select * from salespeople where Sname like 'P__I%'
-----------------------------------------------------------------------------------
--32. Write a query that uses a sub query to obtain all orders for the 
--customer named ‘Cisneros’. Assume you do not know his customer number.
select * from customers where cnum in 
(select cnum from orders1 where 

--33. Find the largest orders for ‘Serres’ and ‘Rifkin’.
select s.sname,max(o.amt) from salespeople s,orders1 o
where s.snum = o.snum
and sname in('serres','rifkin')
group by s.sname

--34. Extract the Salespeople table in the following order: SNUM, SNAME, COMMISSION, CITY.
Select snum,sname,comm as commission,city from salespeople

--35. Select all customers whose names fall in between ‘A’ and ‘G’ alphabetical range.

Select * from customerss where cname between 'a' and 'g'

--36. Select all the possible combinations of customers that you can assign.
XX
select * from orders1
--37. Select all orders that are greater than the average for October 4.
select * from orders1 where amt >(
select avg(amt) from orders1 where odate ='04-oct-1996')

--38. Write a select command using a correlated sub query that selects the 
--names and numbers of all customers with ratings equal to the maximum for their city.
select cname,cnum,rating from customerss 
xx
--39. Write a query that totals the orders for each day and places the 
--results in descending order.
select count(amt),odate from orders1
group by odate
order by odate

select * from orders
select Count(onum),odate from orders1
Group by odate

--40. Write a select command that produces the rating followed by the name of 
--each customer in San Jose.
select rating,cname from customerss
where city ='san jose'


--41. Find all orders with amounts smaller than any amount for a customer in San Jose.
Select * from orders1
where amt<any(Select Amt from orders1 where cnum in 
(select Cnum from customerss where city='san jose'))

select * from orders1
where amt<any(select amt from orders1 where cnum in
(select cnum from customerss where city ='san jose'))




--42. Find all orders with above average amounts for their customers.
select * from (
select onum,amt,cnum,avg(amt) over(partition by cnum) avg_amt from orders1
)where amt>avg_amt


--43. Write a query that selects the highest rating in each city.
select city,max(rating) from customerss
group by city

--44. Write a query that calculates the amount of the salesperson’s commission 
--on order by a customer with a rating above 100.00.

select 

select onum,(amt*comm),c.rating from orders1 o, salespeople s, customerss c
where o.snum=S.snum and o.cnum=c.cnum and rating>100.00

--45. Count the customers with rating above San Jose’s average.
Select Count(cnum), rating from customers where rating >
(select avg(rating) from customers where city ='San Jose')
group by rating
------------------------------------------------------------------------
--46. Write a query that produces all pairs of salespeople with themselves as well as duplicate rows with the order reversed.
--47. Find all salespeople that are located in either Barcelona or London.
select * from salespeople where city='Barcelona' or City='London'

--48. Find all salespeople with only one customer.
select snum,cnum from Customers 
select count(cnum),snum from customers
group by snum having Count(cnum)=1

--49. Write a query that joins the Customer table to itself to find all pairs of customers
-- served by a single salesperson.
select * from customerss
select c.cname,c.snum,d.cname,d.snum from customerss c,customerss d
where c.snum = d.snum
xx

--50. Write a query that will give you all orders for more than $1000.00.
select * from orders
where amt > 1000.00

--51. Write a query that lists each order number followed by the name of the customer 
--who made that order.
select o.onum,c.cname from customerss c,orders1 o
where c.cnum = o.cnum

select onum,cname from orders o, customers c
where o.cnum=c.cnum

select * from salespeople
--52. Write 2 queries that select all salespeople (by name and number) who have customers 
--in their cities who they do not service, one using a join and one a correlated subquery.
--Which solution is more elegant?
select distinct s.sname,s.snum,s.city from salespeople s,customerss c
where c.snum<>s.snum
and c.city = s.city



select * from customerss
--53. Write a query that selects all customers whose ratings are equal than ANY
 (in the SQL sense) of Serres.
--54. Write2 queries that will produce all orders taken on October3 or October 4.
select * from orders
where to_char(odate = '03-Oct')and Odate = '04-Oct-1996'

--55. Write a query that produces all pairs of orders by a given customer. 
--Name that customer and eliminate duplicates.


--56. Find only those customers whose ratings are higher than every customer in Rome.
select * from customers 
where rating>(select max(rating)from customers where city='Rome')

--57. Write a query on the customers table whose output will exclude all customers 
--with a rating < = 100.00, unless they are located in Rome.
select * from customerss
where rating<=100.00 and city='Rome'

--58. Find all rows from the Customer table for which the salesperson number is 1001.
select * from customerss where snum = 1001
select * from customers where snum=1001

--59. Find the total amount in Orders for each salesperson for which this total is greater
-- than the amount of the largest order in the table.
select snum,sum(amt)from orders1
group by snum
having sum(amt)>(select max(amt)from orders1)


select snum, sum(amt)from orders
group by snum
having sum(amt)>(select max(amt)from orders)

--60. Write a query that selects all orders that have Zeroes or NULL in the Amount field..
select * from orders1
where amt like '%0%' or amt is null.

select * from orders where amt is null

--61. Produce all combinations of salespeople and customer names such that the former 
--precedes the latter alphabetically, and the latter has a rating of less than 200.
xx

--62. List all salespeople’s names and the commission they have earned.
select s.sname,s.comm*o.amt from salespeople s,orders1 o
where 
s.snum = o.snum
and s.comm = o.amt*s.comm

select sname, comm*amt from salespeople s, orders1 o
 where s.snum=o.snum

--63. Write a query that produces the names and cities of all customers with the 
--same rating as Hoffman. Write the query using Hoffman’s CNUM rather than his rating,
-- so that it would still be usable if his rating changed.


select cname,city from customers where rating =
 (select rating from customers where cnum in (select cnum from customers where cname ='Hoffman'))

--64. Find all salespeople for whom there are customers that follow them in alphabetical order.
select sname, cname from salespeople s, customers c
where s.snum=c.snum
order by cname asc


--65. Write a query that produces the names and ratings of all customers of all who have 
--above average orders.
select cname, rating, amt from customers c, orders o
where c.cnum= o.cnum and amt>(select avg(amt)from orders)

--66. Find the sum of all purchases from the Orders table.
select sum(amt)from orders

--67. Write a select command that produces the order number, amount, and date for all rows
-- in the Order table.
select onum,amt,odate from orders

--68. Count the number of not null rating fields in the Customer table including duplicates.
select count(rating)from customers

--69. Write a query that gives the names of both the salesperson and the customer for each order
-- after the order number.
select onum,cname,sname from orders o, customers c, salespeople s
where o.cnum=c.cnum and c.snum=s.snum

--70. List the commissions of all salespeople servicing customers in London.
select comm, s.snum from salespeople s, customers c
where s.snum=c.snum and c.city='London'

select * from customers

--71. Write a query using ANY or ALL that will find all salespeople who have no customers
-- located in their city.
select snum, city from customers 
where city!=all(select city from salespeople)


--72. Write a query using the EXISTS operator that selects all salespeople with customers 
--located in their cities who are not assigned to them.
select * from salespeople


--73. Write a query that selects all customers serviced by Peel or Monika.
select * from customers where snum in (select snum from salespeople
where sname in ('Peel','Monika'))

--74. Count the number of salespeople registering orders for each day.
-- (If a salesperson has more than one order on a given day, 
 --he or she should be counted only once.).
 select count( distinct snum),odate from orders
 group by odate
 --------------------------------------------------------------------------------
--75. Find all orders attributed to salespeople in London.
select * from orders 
where snum in (select snum from salespeople where city='London')

--76. Find all orders by customers not located in the same cities as their salespeople.
select * from orders
where cnum in(select cnum from customers where city not in (select city from salespeople))

--77. Find all salespeople who have customers with more than one current order.
select snum, count(cnum) from orders
group by snum having Count(cnum)>1



--78. Write a query that extracts from the Customer table every customer assigned to
-- a salesperson who currently has at least one other customer 
-- (besides the customer being selected) with orders in the Orders table.

--79. Write a query that selects all customers whose name begins with ‘C’.
select * from customers where cname like'C%'

--80. Write a query on the Customers table that will find the highest rating in each city.
-- Put the output in this form:  for the city (city) the highest rating is : (rating).

--81. Write a query that will produce the Snum values of all salespeople with orders
-- currently in the Orders table without any repeats.
select distinct snum from orders

--82. Write a query that lists customers in descending order of rating. 
--Output the rating field first, followed by the customers’ names and numbers.
select rating,cname,cnum from customers
order by rating desc


--83. Find the average commission for salespeople in London.
select avg(comm)from salespeople where city = 'London'

--84. Find all orders credited to the same salesperson that services Hoffman.
select * from orders where snum in (select snum from customers where cname='Hoffman')

--85. Find all salespeople whose commission is in between 0.10 and 0.12 both inclusive
select * from salespeople where comm between 0.10 and 0.12

--86. Write a query that will give you the names and cities of all salespeople in London 
--with commission above 0.10
select sname,city from salespeople where city = 'London' and comm>0.10

--87. What will be the output from the following query? 
--SELECT * FROM ORDERS WHERE (AMT < 1000 OR NOT (ODATE = 10/03/1996 AND CNUM > 2003));
3003  767.19  03-Oct-96 13:45  2001  1001
3007  75.75  04-Oct-96 16:02  2002  1003

--88. Write a query that selects each customer’s smallest order.
select cnum,min(amt)from orders
group by cnum

--89. Write a query that selects the first customer in alphabetical order
--whose name begins with ‘G’.
select * from customers where cname li



--90. Write a query that counts the number of different not NULL city values in the
--Customers table.
select count(city) from customers

--91. Find the average amount from the Orders table.
select Avg(amt)from orders

92. What would be the output from the following query?
SELECT*FROM ORDERS WHERE NOT  (Odate =10/03/1996 OR Snum>1006) AND amt. >=1500);

--93. Find all customers who are not located in San Jose & whose rating is above 200.
select * from customers where city != 'San Jose' And Rating >200

--94. Give a simpler way to write this query:
SELECT Snum, Sname, city, Comm FROM salespeople WHERE (Comm>0.12 and Comm <0.14);
select * from customers where (Comm>0.12 and Comm <0.14);
select * from customers where comm=0.13

--95. Evaluate the following query:
SELECT * FROM orders WHERE NOT ((Odate = 10/03/1996 AND Snum>1002) OR amt>2000);

--96. Which salespeople attend to customers not in the city they have been assigned to?
select * from salespeople where city not in (select city from customers)


--97. Which salespeople get commission greater than 0.11 and serving customers 
--rated less than 250?
select comm,s.snum,rating from salespeople s, customers c
where s.snum=c.snum and comm>0.11 and rating<250

--98. Which salespeople have been assigned to the same city but get different commission 
--percentages?

--99. Which salesperson has earned the most by way of commission?
select max(comm), snum from salespeople
group by snum

100.  Does the customer who has placed the maximum number of orders have the maximum rating?
101.  Has the customer who has spent the largest amount of money been given the highest rating?
--102.  List all customers in descending order of customer rating.
select * from customers 
order by rating desc


--103.  On which days has Hoffman placed orders?
select odate, onum,c.cnum from customers c,orders o
where c.cnum=o.cnum and cname='Hoffman'

--104.  Do all salespeople have different commissions?


105.  Which salespeople have no orders between 10/03/1996 and 10/05/1996?
106.  How many salespersons have succeeded in getting orders?
--107.  How many customers have placed orders?
select onum,c.cnum from customers c, orders o
where c.cnum = o.cnum
group by onum

select count(cnum),onum from orders1
group by cnum


108.  On which date has each salesperson booked an order of maximum value?
select * from salespeople
select * from orders1
select odate, snum ,max(amt)from orders1
group by snum,odate

--109.  Who is the most successful salesperson?
select * from(select snum,sum(amt)from orders1
group by snum
order by sum(amt)desc)
where rownum = 1

select * from(
select s.sname,s.snum,sum(o.amt) from salespeople s inner join orders1 o
on s.snum = o.snum
group by s.sname,s.snum
order by sum(o.amt) desc)
where rownum = 1


select * from orders1
select * from salespeople

--110.  Who is the worst customer with respect to the company?
select * from customerss
select * from orders1

select cname from customerss where cnum in
(select cnum from orders1 where amt in (select min(amt)from orders1))

select * from (
select c.cname,min(o.amt)from customerss c inner join orders1 o
on c.cnum = o.cnum
group by c.cname
order by min(o.amt))
where rownum = 1

--111.  Are all customers not having placed orders greater than 200 totally been 
--serviced by salesperson Peel or Serres?


select * from customerss
select * from orders1
select * from salespeople

--112.  Which customers have the same rating?
select c1.cname,c2.cname,c1.rating from customerss c1 , customerss c2
where c1.rating = c2.rating
and c1.cnum<>c2.cnum


--113.  Find all orders greater than the average for October 4th.
select * from orders1 where amt >
(select avg(amt)from orders1 where odate = '04-oct-1996')

--114.  Which customers have above average orders?
select * from customerss where snum in
(select snum from orders1 where amt in
(select amt from orders1 where amt> (select avg (amt)from orders1)))
--
select * from orders1
select distinct (c.cname),o.amt from customerss c inner join orders1 o
on c.snum = o.snum
and o.amt > (select avg(amt)from orders1)

--115.  List all customers with ratings above San Jose’s average.
select * from customerss where rating >
(select avg(rating) from customerss where city = 'san jose')

--116.  Select the total amount in orders for each salesperson for which the total is 
--greater than the amount of the largest order in the table.
select * from orders1
select snum,sum(amt) from orders1
group by snum
having sum(amt)>(select max(amt)from orders1)

--117.  Give names and numbers of all salesperson that have more than one customer.
select * from salespeople
select * from customerss

SELECT s.sname, COUNT(c.cnum)FROM salespeople s JOIN customerss c 
ON s.snum = c.snum
GROUP BY s.snum, s.sname
HAVING COUNT(c.cnum) > 1;


select s.snum,s.sname, count(c.cnum) from customerss c, salespeople s
where c.snum = s.snum
group by s.snum,s.sname
having count(c.cnum)>1


--118.  Select all salesperson by name and numbers who have customers in their city 
--whom they don’s the service.
select * from salespeople
select * from customerss
select s.snum,s.sname,s.city,c.cname,c.city from salespeople s inner join customerss c
on s.city = c.city
and s.snum not in (select c.snum from customerss)


--119.  Which customers’ rating should be lowered?


--120.  Is there a case for assigning a salesperson to Berlin?
select * from salespeople where snum in
(select snum from customerss where city = 'berlin')

--121.  Is there any evidence linking the performance of a salesperson to commission 
--that he or she is being paid?
select * from customerss
select * from orders1
select * from salespeople
--122.  Dose the total amount in orders by customer in Rome and London exceeds the 
--commission paid to salesperson in London and New York by more than 5 times?
select sum(amt) from orders1 
where cnum in (select cnum from customerss where city in('rome','london'))>

select (o.amt*s.comm)*5 from orders1 o join salespeople s
on o.snum = s.snum
and s.city in ('london','new york')

select * from salespeople
select * from customerss


--123.  Which is the date, order number, amt and city for each salesperson (byname) 
--for   the maximum order he has obtained?
select s.sname,o.odate,o.onum,max(o.amt),s.city from salespeople s join orders1 o
on s.snum = o.snum
group by s.sname,o.odate,o.onum,s.city



--124.  Which salesperson(s) should be fired?
--125.  What is the total income for the company? 
---
--
--
--
--
--
--
--
-
--
--
-
--
--
--
--
--
--
--
--
--
--
--
--
--
--
--
--
--
--
--
--
--

-----------------------------------------
========================================
=======================================
------------------------------------------
------------------------------------------
------------------------------------------
--------------------------------------
---Mayur Basic Questions
--------------------------------------------
--------------------------------------------
--------------------------------------------
-----------------------------------------------
----------------------------------------------

--1) Display the details of all employees
select * from hr.employees

--2) Display the depart information from department table
select * from hr.departments

--3) Display the name and job for all the employees
select first_name,last_name,job_id from hr.employees

--4) Display the name and salary  for all the employees
select first_name,last_name,salary from hr.employees

--5) Display the employee no and totalsalary  for all the employees
select employee_id,salary+salary * nvl(commission_pct,0) from hr.employees

select * from hr.employees


select employee_id ,(salary+salary*nvl(commission_pct,0)) from hr.employees

--6) Display the employee name and annual salary for all employees.
select first_name,last_name,(salary+salary*nvl(commission_pct,0))*12 from hr.employees
select first_name,(salary+salary*nvl(commission_pct,0))*12 from hr.employees

--7) Display the names of all the employees who are working in depart number 10.
select * from hr.employees where department_id = 10
select first_name,last_name, department_id from hr.employees
where department_id=10

--8) Display the names of all the employees who are working as clerks and
   --drawing a salary more than 3000.
   select first_name,job_id,salary from hr.employees
   where job_id like '%CLERK%' and salary >3000
   
   select first_name,last_name,job_id,salary from hr.employees
   where job_id like'%CLERK%' and salary>3000
   
--9) Display the employee number and name  who are earning comm.

select employee_id,first_name,last_name,commission_pct from hr.employees
where commission_pct is not null
   select * from hr.employees
select employee_id,first_name,last_name,commission_pct from hr.employees
where commission_pct is not null

--10) Display the employee number and name  who do not earn any comm.
select * from hr.employees where commission_pct is null
select employee_id,first_name,last_name,commission_pct from hr.employees
where commission_pct is null
select * from hr.employees

--11) Display the names of employees who are working as clerks,salesman or
--analyst and drawing a salary more than 3000.
select first_name,last_name,salary from hr.employees
where job_id in ('SH_CLERK','SA_REP','ANALYST') and salary>3000

select first_name,job_id,salary from hr.employees
where salary>3000 and job_id like '%CLERK%' or job_id like'%SALESMAN%' or job_id like '%ANALYST%'


select first_name,job_id,salary from hr.employees
where job_id like '%CLERK%' or job_id like'%SALESMAN%' or job_id like '%ANALYST%'
and salary>3000
select * from hr.employees

--12) Display the names of the employees who are working in the company for the past 5 years;
select first_name,last_name from hr.employees
where sysdate - hire_date > 5

select * from hr.employees
where months_between(sysdate,hire_date)/12>5

select * from hr.employees
select First_name,hire_date from hr.employees
where months_between(sysdate,hire_date)/12>=5

--13) Display the list of employees who have joined the company before
--30-JUN-90 or after 31-DEC-90.
select * from hr.employees
where hire_date<to_date('30-jun-1990') or hire_date>to_date('31-dec-1990')


select * from hr.employees
where hire_date < to_date('30-JUN-90')
or hire_date> to_date('31-DEC-90')

--14) Display current Date.
select sysdate from dual

--15) Display the list of all users in your database(use catalog table).

--16) Display the names of all tables from current user;

--17) Display the name of the current user.


--18) Display the names of employees working in depart number 10 or 20 or 40
--or employees working as CLERKS, SALESMAN or ANALYST.
select * from hr.employees
where department_id in(10,20,40) or job_id like'%CLERK%'

select employee_id,department_id,job_id from hr.employees
where department_id in(10,20,40) or 
job_id like'%CLERK%' or job_id like'%SALESMAN%' or job_id like'%ANALYST%'



 --19) Display the names of employees whose name starts with alphabet S.
 
 select * from hr.employees where first_name like 'S%'
 
 select First_name from hr.employees
 where first_name like'S%'
 
 
 --20) Display the Employee names for employees whose name ends with alphabet S.
 select * from hr.employees where first_name like '%s'
 select * from hr.employees
 select first_name from hr.employees
 where first_name like '%S'

select * from hr.employees

--21) Display the names of employees whose names have second alphabet A in their names.
select first_name from hr.employees where first_name like '_a%'
select first_name from hr.employees
where first_name like '_a%'

--22) select the names of the employee whose names is exactly five characters in length.
select * from hr.employees where length(first_name)=5
select * from hr.employees where first_name like '_____'
select first_name from hr.employees
where length(first_name)=5
--23) Display the names of the employee who ar e not working as MANAGERS.
select * from hr.employees where job_id not like '%MAN%'

select * from hr.employees
where job_id not like'%MAN%'
--24) Display the names of the employee who are not work ing as SALESMAN OR CLERK OR ANALYST.
select * from hr.employees
where job_id not in ('AD_PRES','AD_VP')

select first_name,job_id from hr.employees
where job_id not in('CLERK','ANALYST','SALESMAN')
--25) Display all rows from EMP table. The system should wait after every
--Screen full of information.


--26) Display the total number of employee working in the company.
select count(*) from hr.employees
select count(*) from hr.employees

--27) Display the total salary being paid to all employees.
select sum(salary + salary*nvl(commission_pct,0)) from hr.employees

select sum(salary+salary*nvl(commission_pct,0))from hr.employees
--28) Display the maximum salary from emp table.
select max(salary) from hr.employees
select max(salary) from hr.employees

--29) Display the minimum salary from emp table.
select min(salary) from hr.employees
--30) Display the average salary from emp table.
select avg(salary) from hr.employees
select avg(salary) from hr.employees
--31) Display the maximum salary being paid to CLERK.
select max(salary) from hr.employees where job_id like ('%CLERK%')
select max(salary) from hr.employees
where job_id like '%CLERK%'

--32) Display the maximum salary being paid to depart number 20.
select max(salary) from hr.employees where department_id = 20

select max(salary)from hr.employees
where department_id=20

--33) Display the minimum salary being paid to any SALESMAN.
select min(salary) from hr.employees
where job_id like '%SA_MAN%'
select min(salary) from hr.employees
where job_id like'%SA_MAN%'

--34) Display the average salary drawn by MANAGERS.
select avg(salary) from hr.employees
where job_id like '%MAN%'

select avg(salary) from hr.employees
where job_id like '%MGR%'

--35) Display the total salary drawn by ANALYST working in depart number 40.
select salary + salary*nvl(commission_pct,0) from hr.employees
where job_id like '%ANALYST%' and department_id = 40
select sum(salary+salary*nvl(commission_pct,0)) from hr.employees
where department_id =40 

--36) Display the names of the employee in order of salary i.e the name of
select first_name, salary from hr.employees
order by salary 

select first_name,last_name,salary from hr.employees
order by salary

--37) Display the names of the employee in descending order of salary.
select first_name, salary from hr.employees
order by salary desc


select First_name,last_name, salary from hr.employees
order by salary desc

--38) Display the names of the employee in order of employee name.
select first_name from hr.employees
order by first_name asc

select first_name from hr.employees
order by first_name

--39) Display empno,ename,deptno,sal sort the output first base on name and
--within name by deptno and with in deptno by sal.
select employee_id,first_name,department_id,salary from hr.employees
order by first_name,department_id,salary

select employee_id,first_name,department_id,salary from hr.employees
order by first_name,department_id,salary

--40) Display the name of the employee along with their annual salary(sal*12).
--The name of the employee earning highest annual salary should apper first.
select first_name,(salary+salary*nvl(commission_pct,0))*12 from hr.employees
order by salary desc
select first_name,(salary+salary*nvl(commission_pct,0))*12 from hr.employees
order by salary desc


--41) Display name,salary,hra,pf,da,total salary for each employee. The
--output should be in the order of total salary,hra 15% of salary,da 10% of salary,pf 5%
--salary,total salary will be(salary+hra+da)-pf.
select first_name,(salary+HRA+DA+PF)as TOTAL_SALARY from (
select first_name,salary,(salary*15/100)as HRA,(salary*10/100) as DA,(salary*5/100)as PF
from hr.employees)

--42) Display depart numbers and total number of employees working in each department.
select department_id,count(employee_id) from hr.employees
group by department_id


select department_id, count(employee_id) from hr.employees
group by department_id
--43) Display the various jobs and total number of employees within each job group..
select job_id, count(employee_id) from hr.employees
group by job_id
select job_id,count( employee_id) from hr.employees
group by job_id
--44) Display the depart numbers and total salary for each department.
select department_id,sum(salary) from hr.employees
group by department_id
select department_id,sum(salary+salary*nvl(commission_pct,0)) from hr.employees
group by department_id
--45) Display the depart numbers and max salary for each department.
select department_id,max(salary) from hr.employees
group by department_id
select department_id,max(salary+salary*nvl(commission_pct,0)) from hr.employees
group  by department_id
--46) Display the various jobs and total salary for each job
select job_id,sum(salary) from hr.employees
group by job_id
select job_id,sum(salary+salary*nvl(commission_pct,0))from hr.employees
group by job_id

--48) Display the depart numbers with more than three employees in each dept.
select department_id,count(employee_id) from hr.employees
group by department_id
having count(employee_id)>3

select department_id,count(employee_id)from hr.employees
group by department_id
having count(employee_id)>3

--49) Display the various jobs along with total salary for each of the jobs
--where total salary is greater than 40000.
select job_id,sum(salary) from hr.employees
group by job_id
having sum(salary)>4000

select job_id,sum(salary+salary*nvl(commission_pct,0))from hr.employees
group by job_id
having sum (salary)>4000

--50) Display the various jobs along with total number of employees in eachjob.
--The output should contain only those  jobs with more than three employees.
select job_id,count(employee_id) from hr.employees
group by job_id
having count(job_id)>3

select job_id,count(employee_id) from hr.employees
group by job_id
having count(employee_id)>3

--51) Display the name of the empployee who earns highest salary.
select first_name from hr.employees
where salary in(select max(salary) from hr.employees)

select first_name,salary from hr.employees
where salary in(select max(salary)from hr.employees)


--52) Display the employee number and name for employee working as clerk and
--earning highest salary among clerks.
select employee_id, first_name from hr.employees
where salary in (select max(salary) from hr.employees where job_id like '%CLERK%')

select employee_id,first_name, salary from hr.employees
where salary in(select max(salary) from hr.employees where job_id like'%CLERK%') 


--53) Display the names of salesman who earns a salary more than the highest
--salary of any clerk.
select first_name,salary,job_id from hr.employees
where salary > (select max(salary) from hr.employees where job_id like '%CLERK%')
and job_id like '%MAN%'



select first_name,job_id,salary from hr.employees
where salary >(select max(salary)from hr.employees where job_id like'%CLERK%')
and job_id like '%REP%'


--54) Display the names of clerks who earn a salary more than the lowest
--salary of any salesman.
select first_name,job_id from hr.employees
where salary > (select min(salary) from hr.employees where job_id like '%REP%')
and job_id like '%CLERK%'

select first_name,salary from hr.employees
where salary>(select min(salary) from hr.employees where job_id like'%REP%')
and job_id like'%CLERK%'

--55) Display the names of the employees who earn highest salary in their
--respective departments
select first_name, salary, department_id from hr.employees
where salary in (select max(salary) from hr.employees group by department_id)


select first_name,salary,department_id from hr.employees
where salary in(select max(salary) from hr.employees group by department_id)

select * from(
select first_name,salary,department_id,
row_number() over(partition by department_id order by salary desc) rn from hr.employees
) where rn=1

select * from(
select first_name,salary, department_id,
row_number() over (partition by department_id order by salary desc) as rn from hr.employees
) where rn = 1

select * from
(select first_name, salary, department_id,
row_number() over (partition by department_id order by salary desc) as RN from hr.employees
) where rn = 1

select * from (
select first_name, salary,department_id,
row_number()over(partition by department_id order by salary desc)as rn from hr.employees
)where rn=1

--56) Display the names of the employees who earn highest salaries in their respective job groups.
select * from(
select first_name,salary,job_id,
row_number()over(partition by job_id order by salary desc) as rn from hr.employees
) where rn = 1

select * from(
select first_name,salary,job_id,
row_number()over ( partition by job_id order by salary desc)rn from hr.employees)
where rn=1

--57) Display the employee names who are working in accounting department.

select first_name from hr.employees where job_id like '%ACCOUNT%'
select first_name,job_id from hr.employees
where job_id like '%ACCOUNT%' 

--58) Display the employee names who are working in London.


select * from hr.employees
select * from hr.departments
select * from hr.locations

select e.first_name,l.city from hr.employees e,hr.departments d,hr.locations l
where e.department_id = d.department_id and d.location_id = l.location_id and city = 'London'


select e.first_name,l.city from hr.employees e,hr.departments d, hr.locations l
where d.location_id=l.location_id and e.department_id=d.department_id
and city ='London'

--59) Display the Job groups having total salary greater than the maximum salary for managers.
select job_id ,sum(salary) from hr.employees
group by job_id
having sum(salary)> (select max(salary) from hr.employees where job_id like '%MGR%')

select job_id,sum(salary) from hr.employees
group by job_id
having sum(salary)>(select sum(salary)from hr.employees where job_id like'%MGR%')

--60) Display the names of employees from department number 10 with salary
--greater than that of any employee working in other department.
select first_name,department_id,salary from hr.employees
where department_id = 10 and  salary>(select max(salary)from hr.employees where department_id <>10)

select first_name,salary,department_id from hr.employees
where department_id=10

--61) Display the names of the employees from department number 10 with
--salary greater than that of all employee working in other departments.
select first_name,salary,department_id from hr.employees
where department_id = 10 and salary > (select avg (salary) from hr.employees where department_id<>10)


--62) Display the names of the employees in Uppercase.
select upper(first_name) from hr.employees
select Upper(first_name) from hr.employees

--63) Display the names of the employees in Lowecase.
select lower(first_name) from hr.employees
select lower(first_name) from hr.employees
--64) Display the names of the employees in Propercase.
select initcap(first_name) from hr.employees

select initcap(first_name)from hr.employees
--65) Display the length of Your name using appropriate function.
select length('PRASHANT')from dual
select length('prashant')from dual
--66) Display the length of all the employee names.
select length(first_name) from hr.employees
select length(first_name)from hr.employees


--67) select name of the employee concatenate with employee number.
select first_name ||' ' || employee_id from hr.employees

select ('A' ||' '|| 'B') from dual

select concat(first_name,employee_id)from hr.employees
--68) User appropriate function and extract 3 characters starting from 2
--characters from the following  string 'Oracle'. i.e the out put should be 'ac'
select substr('ORACLE',2,3)from dual

select substr('oracle',2,3)from dual

--69) Find the First occurance of character 'a' from the following string i.e
'Computer Maintenance Corporation'.
select instr('Computer Maintenance Corporation','a',1)from dual
select instr('Computer Maintenance Corporation','a',1,1)from dual


--70) Replace every occurance of alphabhet A with B in the string Allens(use
--translate function)
select replace('ALLEN','A','B')from dual

select translate('allens','a','b') from dual
--71) Display the informaction from emp table.Where job manager is found it
--should be displayed as boss(Use replace function).
select * from hr.employees
select first_name,replace (job_id,'AD_PRES','BOSS') from hr.employees
select replace(job_id,'AD_VP','boss')from hr.employees

select * from hr.employees
--72) Display empno,ename,deptno from emp table.Instead of display department
--numbers[B1]  display the related department name(Use decode function).
select employee_id,first_name,decode(department_id,department_id,job_id)as dept from hr.employees

select employee_id,first_name,decode(department_id,department_id,job_id) from hr.employees 

--73) Display your age in days.
select to_date(sysdate)-to_date('22-Mar-1989') from dual

--74) Display your age in months.
select months_between(to_date(sysdate),to_date('22-mar-1989'))from dual
--75) Display the current date as 15th Augest Friday Nineteen Ninety Saven.
select to_char(current_date,'DDTH MONTH YEAR')from dual

--76) Display the following output for each row from emp table.
 
scott has joined the company on wednesday 13th August ninten nintey.
select first_name ||'hs joined the company on'||to_char(hire_date,'DAY')||
to_char(hire_date,'ddth month year') from hr.employees

select first_name ||'has joined the company on'||to_char(hire_date,'DAY')||
to_char(hire_date,'DDTH MONTH YEAR')from hr.employees
--77) Find the date for nearest saturday after current date.

--78) Display current time.
select (systimestamp) from dual
--79) Display the date three months Before the current date.

--80) Display the common jobs from department number 10 and 20.

select job_id from hr.employees where department_id =10 and
 job_id in (select job_id from hr.employees where department_id = 20)

----------------------
----------------------
--------------------
---_--GARAGEE DATA
--------------

--
---
--
--
--

-----
---
--
-

---
---
--
---
--
--

--
--
--
-
-
---
---
--System Questions.
-- Q.1 List all the customers serviced.
Ans – 
 select * from ser_det
  select * from customer1
select c.CID, Cname, C_contact from customer1 c, ser_det s
where c.cid = s.cid
--
--Q.2 Customers who are not serviced.
--
select c.cid,c. cname from customer1 c, left outer join ser_det s 
where s.cid is null

select * from customer1
where cid not in(select cid from ser_det)

--.3 Employees who have not received the commission.
--
select * from employee
select * from ser_det
 select e.eid,e.ename 
  select e.eid from employee e,ser_det s
  where e.eid=s.eid(+) and s.comm=0
  
  select distinct(eid) from ser_det
  where comm = 0
  
  select * from employee
  where eid in (select eid from ser_det where comm='0')
  
--Q.4 Name the employee who have maximum Commission.
--
select distinct e.ename , s.comm from employee e, ser_det s
where e.eid = s.eid and comm in(select max(comm)from  ser_det)

select * from employee
where eid in (select eid from ser_det where comm in (select max(comm) from ser_det))
--Q.5 Show employee name and minimum commission amount received by an employee.

select * from employee
where eid in (select eid from ser_det where comm in (select min (comm) from ser_det))

select  distinct e.ename , s.comm from employee e, ser_det s
where e.eid = s.eid and comm in(select min(comm)from  ser_det)
--Q.6 Display the Middle record from any table.
select * from ser_det
where rownum<= (select count (*)/2 from ser_det)
Minus
select * from ser_det
where rownum <= (select (count (*)/2)-1 from ser_det)

--Q.7 Display last 4 records of any table.
select * from ser_det
where rownum<= (select count (*) from ser_det)
Minus
select * from ser_det
where rownum <= (select count (*)-4 from ser_det)

--Q.8 Count the number of records without count function from any table.
select * from employees
select sum(2) from employees

--Q.9 Delete duplicate records from "Ser_det" table on cid.
--(note Please rollback after execution).
select distinct()from ser_det

--Q.10 Show the name of Customer who have paid maximum amount 
select * from ser_det
select * from customer1
where cid in (select Cid from ser_det where total in (select max(total) from ser_det))

--Q.11 Display Employees who are not currently working.
select * from employee
where eid not in (select eid from ser_det)

Q.12 How many customers serviced their two wheelers.
--Q.13 List the Purchased Items which are used for Customer Service with Unit of that Item
select * from sparepart
select * from ser_det
select spname,spunit from sparepart
where spid in (select spid from ser_det)
--Q.14 Customers who have Colored their vehicles.
 -- 
 select * from customer1
 where cid in (select cid from ser_det where typ_ser='color')
  select * from customer1
    select * from ser_det

    select c.cid,c.cname, s.cid, s.Typ_veh, s.typ_ser from customer1 c  inner join ser_det s
     on (c.cid = s.cid )

     where Typ_ser = 'color'
     
     
    select c.cid,c.cname, s.cid, s.Typ_veh, s.typ_ser from customer1 c , ser_det s
     where c.cid = s.cid 
     and Typ_ser = 'color'
     
     select * from customer1
     where CID in (select cid from ser_det where Typ_ser='color')
    
--Q.15 Find the annual income of each employee inclusive of Commission
select * from employee
select * from ser_det

select distinct (e.eid) ,(e.Esal +(esal*decode(Comm,0,1,comm)))*12  from employee e full outer join ser_det s
on e.eid=s.eid

--Q.16 Vendor Names who provides the engine oil.
select * from sparepart
select * from purchase
select * from vendors
where vid in (select vid from purchase where spid in (
select spid from sparepart where spname like '%oil%'))

--Q.17 Total Cost to purchase the Color and name the color purchased.
select * from purchase
select * from sparepart

select s.spid,s.spname,p.total from purchase p, sparepart s
where S.spid = p.spid and SPname like '%colour'


--Q.18 Purchased Items which are not used in "Ser_det".
select * from purchase
select * from ser_det
select * from purchase
where spid in (select spid from purchase minus select spid from ser_det)

select * from purchase
where spid in (select spid from purchase minus select spid from ser_det)



----Q.19 Spare Parts Not Purchased but existing in Sparepart
--
select * from sparepart
select * from purchase
select * from sparepart
where spid in (select spid from sparepart minus select spid from purchase)

select * from sparepart
where spid in (select spid from sparepart minus select spid from purchase)



Q.20 Calculate the Profit/Loss of the Firm. consider one month salary of each employee for Calculation.
--Q.21 Specify the names of customers who have serviced their vehicles more than one time.

select * from customer1
where cid in
(select cid from ser_det 
group by Cid
having count(cid)>1)


--Q.22 List the Items purchased from vendors locationwise.
select * from vendors
select * from Sparepart
select * from purchase

select v.vname,v.vadd,v.vid, s.spid , s.spname, p.vid, p.spid 
from vendors v, sparepart s, purchase p
where v.vid = p.vid and s.spid = p.spid

--Q.23 Display count of two wheeler and four wheeler from ser_details
select 'two wheeler',count(typ_veh)from ser_det
where typ_veh='two wheeler' 
union
select 'four wheeler',count(typ_veh) from ser_det
where typ_veh='four wheeler'

select * from ser_det

select count 
(case 
when TYp_veh = 'two wheeler' then 1 end) as "TWO WHEELER",
  count 
(case 
when TYp_veh = 'four wheeler' then 2 end) as "four WHEELER"
  from ser_det

--Q24 Display name of customers who paid highest SPGST and for which item 
select * from purchase
select * from customer1
select * from sparepart
select * from ser_det

select cname,spname
from customer1 c,ser_det se,sparepart s
where c.cid=se.cid and s.spid=se.spid and sp_g in(select max(sp_g) from ser_det)

--Q25 Display vendors name who have charged highest SPGST rate  for which item
select * from vendors
select * from sparepart
select * from purchase
select v.vname, s. spname, p.spgst from vendors v,sparepart s,purchase p
where v.vid = p.vid and s.spid=p.spid and spgst in(select max(spgst) from purchase)

--Q26   list name of item and employee name who have received item
select * from employee
select * from sparepart
select * from ser_det
select e.eid,e.ename , s.spname, s.spid from employee e, sparepart s, ser_det d
where e.eid = d.eid and  s.spid = d.spid

 
--Q27 Display the Name and Vehicle Number of Customer who serviced his vehicle, 
--And Name the Item used for Service, And specify the purchase date of that Item with
-- his vendor and Item Unit and Location, And employee Name who serviced the vehicle. 
 --for Vehicle NUMBER "MH-14PA335".'
 select * from customer1
 select * from ser_det
 select * from sparepart
 select * from purchase
select * from vendors
select * from employee


 select c.cid, c.cname, s.veh_no, sp.spname , p.pdate,v.vname,v.vadd,e.ename 
 from customer1 c ,sparepart sp, ser_det s , purchase p, vendors v, employee e
 where 
 c.cid = s.cid and 
 s.spid = sp.spid and 
 sp.spid = p.spid and 
 p.vid = v.vid and 
 e.eid = s.eid and s.veh_no='mh14pa335'

 
--Q28 who belong this vehicle  MH-14PA335" Display the customer name 
select * from ser_det
select * from customer1
where cid in (select cid from ser_det where VEH_NO='mh14pa335')


--Q29 Display the name of customer who belongs to New York and when he /she 
--service their  vehicle on which date   
select * from customer1
select * from ser_det

select c.cname ,c.cadd,s.ser_date from customer1 c, ser_det s
where c.cid = s.cid  and cadd = 'new york'

--Q 30 from whom we have purchased items having maximum cost?
select * from purchase
select * from vendors
select * from sparepart


select * from vendors
where vid in (select vid from purchase where total in (select max(total) from purchase))


--Q31 Display the names of employees who are not working as Mechanic and 
--that employee done services 
 --
  select * from ser_det
select e.ename ,e.ejob,e.eid from employee e, ser_det s
where e.eid = s.eid and e.ejob !='mechanic'

select * from employee
where eid in (select eid from ser_det where ejob !='mechanic')
  

Q32 Display the various jobs along with total number of employees in each job. The output should
contain only those jobs with more than two employees.
Q33 Display the details of employees who done service  and give them rank according to their no. of services .
--Q 34 Display those employees who are working as Painter and fitter and 
--who provide service and total count of service done by fitter and painter  
select * from employee
select * from ser_det

select e.ename, e.ejob,count (s.cid) from employee e, ser_det s
where e.eid = s.eid and e.ejob in ('painter','fitter')
group by ejob,ename

Q35 Display employee salary and as per highest  salary provide Grade to employee 
----Q36  display the 4th record of emp table without using group by and rowid
select * from employee
select * from employee 
where rownum <=4
minus
select * from employee
where rownum <=3

Q37 Provide a commission 100 to employees who are not earning any commission.
Q38 write a query that totals no. of services  for each day and place the results
in descending order
--Q39 Display the service details of those customer who belong from same city 
select * from ser_det
select * from customer1

select * from ser_det
where cid in (select cid from customer1 where cadd='new york')

--Q40 write a query join customers table to itself to find all pairs of
--customers service by a single employee
select * from customer1

--Q41 List each service number follow by name of the customer who made  that service
select * from ser_det
select * from customer1
select s.sid, c.cname from ser_det s, customer1 c
where s.cid = c.cid

Q42 Write a query to get details of employee and provide rating on basis of  maximum services provide by employee  .Note (rating should be like A,B,C,D)
Q43 Write a query to get maximum service amount of each customer with their customer details ?
Q44 Get the details of customers with his total no of services ?
--Q45 From which location sparpart purchased  with highest cost ?
select * from sparepart
select * from purchase
select * from vendors
select vadd from vendors
where vid in (select vid from purchase where total in(select max(total) from purchase))

--Q46 Get the details of employee with their service details who has salary is null
select * from employee
select * from ser_det
select e.ename , e.ejob, e.eadd , e.esal from employee e, ser_det s
where e.eid=s.eid and e.esal is null



--Q47 find the sum of purchase location wise 
select * from purchase
select * from vendors

select v.vadd, count(p.total) as "SUM" from vendors v,purchase p
where v.vid = p.vid 
group by vadd


--Q48 write a query sum of purchase amount in word location wise ?

select v.vadd, sum(p.total) as "SUM" from vendors v,purchase p
where v.vid = p.vid 
group by vadd


Q49 Has the customer who has spent the largest amount money has
been give highest rating

--Q50 select the total amount in service for each customer for which
--the total is greater than the amount of the largest service amount in the table
select * from ser_det
select * from customer1

select cid, sum(total) from ser_det
where cid in (select cid from customer1)
group by (cid)
having sum(total)>max(total)


--Q51  List the customer name and sparepart name used for their vehicle and  vehicle type
select * from ser_det
select * from sparepart 
select * from ser_det


select c.cname ,s.spname, sd.typ_veh from customer1 c,sparepart s, ser_det sd
where C.cid = sd.cid and  s.spid = sd.spid
--Q52 Write a query to get spname ,ename,cname quantity ,rate ,service amount for record 
--exist in service table 
select * from sparepart
select * from employee
select * from ser_det
select s.spname, e.ename , c.cname, sd.qty, sd.sp_rate, sd.ser_amt 
from sparepart s, employee e, ser_det sd, customer1 c
where s.spid = sd.spid and e.eid = sd.eid and c.cid = sd.cid


--Q53 specify the vehicles owners who’s tube damaged.
select * from customer1
where cid in (select cid from ser_det where typ_ser='tube damaged')

--Q.54 Specify the details who have taken full service.
select * from customer1
where cid in(select cid from ser_det where typ_ser like '%full%')

--Q.55 Select the employees who have not worked yet and left the job.
select * from employee
select * from ser_det

select * from employee
where eid not in (select eid from ser_det) and edol is not null

Q.56  Select employee who have worked first ever.
--Q.57 Display all records falling in odd date
select * from ser_det
where mod (to_char(Ser_date,'dd'),2)=1

--Q.58 Display all records falling in even date
select * from ser_det
where mod(to_char(ser_date,'dd'),2)=0
--Q.59 Display the vendors whose material is not yet used.
select * from purchase 
select * from ser_det
select * from sparepart
select * from vendors
where vid in (select vid from purchase where spid not in(select spid from Ser_det))


--Q.60 Difference between purchase date and used date of spare part.
select * from ser_det
select * from purchase
select s.ser_date, p.pdate from ser_det s, purchase p
where s.spid = p.spid 

---------------------------
---------------------------
---------------------------
---------------------------
---------------------------

------------------
---------- EMPLOYEE AND INCENTIVES
---------------
------------------------------------
------------------------------------
------------------------------------

================

create table employee1
(
emp_id number,
First_name varchar2(30),
Last_name varchar2(20),
Salary number,
Joining_date date,
Department varchar2(10)
)

select * from employee1

insert into employee1 values(6,'Philip','Mathew',750000,'01-Jan-13','services')

create table Incentives
(
Employee_ref_id number,
Incentive_date date,
Incentive_amount number
)

insert into incentives values(2,'01-Jan-13',3500)
select * from incentives
--------------------------------------------------------------
                          -- Q & A
---------------------------------------------------------------
--1.  Write create table syntax for employee table and Incentive table
create table employee1
(
emp_id number,
First_name varchar2(30),
Last_name varchar2(20),
Salary number,
Joining_date date,
Department varchar2(10)
)

create table Incentives
(
Employee_ref_id number,
Incentive_date date,
Incentive_amount number
)

--2.  Write syntax forinsert data into table of employee table and Incentive table
insert into employee1 values(6,'Philip','Mathew',750000,'01-Jan-13','services')
insert into incentives values(2,'01-Jan-13',3500)

--3.  Get all employee details from the employee table
select * from employee1

--4.  Get First_Name,Last_Name from employee table
select first_name,last_name from employee1

--5.  Get First_Name from employee table using alias name “Employee Name”
select first_name as Employee_NAME from employee1
select First_name as Employee_name from employee1

--6.  Get First_Name from employee table in upper case
select upper(first_name) from employee1
select upper(first_name) from employee1

--7.  Select first 3 characters of FIRST_NAME from EMPLOYEE
select substr(first_name,1,3)from employee1
select substr(first_name,1,3) from employee1

--8.  Get position of 'o' in name 'John' from employee table.
select instr(first_name,'o',1) from employee1 where first_name = 'John'
select instr(first_name,'o',1) from employee1
where first_name ='John'

--9.  Get FIRST_NAME from employee table after removing white spaces from right side.
select rtrim(first_name,' ') from employee1
select rtrim(first_name,' ') from employee1

--10. Get First_Name from employee table after replacing 'o' with '$'
select translate(first_name,'o','$')from employee1 where rownum= 1

select replace (first_name,'o','$') from employee1

--11. Get First_Name and Last_Name as single column from employee table separated by a '_'

select first_name||'_'||last_name from employee1


select concat(first_name,concat('_',last_name)) from employee1

--12. Get FIRST_NAME, Joiningyear, Joining Month and Joining Date from employee table
select first_name,to_char(joining_date,'YYYY')as Year,to_char(joining_date,'Mm')as month from employee1

select first_name, to_char(joining_date,'YYYY') YEAR,
to_char(joining_date,'MM') MONTH, to_char(joining_date,'DD')DAY  from employee1

--13. Get all employee details from the employee table order by First_Name Ascending
select * from employee1
order by first_name

select * from employee1
order by First_name

--14. Get all employee details from the employee table order by 
--First_Name Ascending and Salary Descending?

select * from employee1
order by first_name asc,salary desc



--15. Get employee details from employee table whose employee name is “John”
select * from employee1 where first_name = 'John'

select * from employee1
where First_name = 'John'


--16. Get employee details from employee table whose employee name are “John” and “Roy”

select * from employee1 where first_name in('John','Roy')

select * from employee1
where First_name = 'John' or first_name='Roy'

--17. Get employee details from employee table whose employee name are not “John” and “Roy”.
select * from employee1
where first_name not in('John','Roy')

select * from employee1
where First_name <> 'John' and first_name<>'Roy'

--18. Get employee details from employee table whose first name starts with 'J'.
select * from employee1
where first_name like 'J%'
select * from employee1
where first_name like 'J%'

--19. Get employee details from employee table whose first name contains 'o'.
select * from employee1 where first_name like '%o%'
select * from employee1
where first_name like '%o%'


--20. Get employee details from employee table whose first name ends with 'n'.
select * from employee1 where first_name like '%n'
select * from employee1
where first_name like '%n'

--21. Get employee details from employee table whose first name ends with 'n' and name 
--contains 4 letters.
select * from employee1 where first_name like '%n' and length(first_name)=4

select * from employee1
where first_name like ('___n')

--22. Get employee details from employee table whose first name starts with 'J' 
--and name contains 4 letters.
select * from employee1 where first_name like 'J%' and length(first_name)=4
select * from employee1
where first_name like ('J___')

--23. Get employee details from employee table who’s Salary greater than 600000.
select * from employee1 where salary >600000
select * from employee1
where salary>600000

--24. Get employee details from employee table whose joining year is “2013”.
select * from employee1 where to_char(joining_date,'yyyy')=2013
select * from employee1
where to_char(joining_date,'YYYY')=2013

--25. Get employee details from employee table whose joining month is “January”.
select * from employee1 where to_char(joining_date,'Mon')='Jan'

select * from employee1
where to_char(joining_date,'Mon')='Jan'

--26. Get employee details from employee table who joined before January 1st 2013.
select * from employee1 where to_char(joining_date,'dd-mm-yyyy') < '01-01-2013'

select * from employee1
where to_char(joining_date,'mm-dd-yyyy')<'01-01-2013'

--27. Get employee details from employee table who joined after January 31st
select * from employee1 where to_char(joining_date,'dd-mon-yyyy')> to_date('31-jan-2013')


select * from employee1 where to_char(joining_date,'dd-mon-yyyy') > to_date('31-jan-2013')

select * from employee1
where joining_date>to_date('31-jan-2013')

--28. Get Joining Date and Time from employee table
--select local_timestamp , joining_date from employee1
--select timestamp,joining_date from employee1

--29. Get Joining Date, Time including milliseconds from employee tab


--30. Get difference between JOINING_DATE and INCENTIVE_DATE from employee and incentives table.
select e.first_name,incentive_date - joining_date from employee1 e inner join incentives i
on e.emp_id = i.employee_ref_id

select e.first_name,incentive_date-joining_date from employee1 e inner join incentives i
on e.emp_id = i.employee_ref_id



--31. Get department, total salary with respect to a department from employee table.
select department,sum(salary) from employee1
group by department

select department, sum(salary) from employee1
group by department

--32. Get department, total salary with respect to a department from employee table
-- order by total salary descending.
select department,sum(salary)as total_salary from employee1
group by department
order by total_salary  desc

select department,sum(salary) from employee1
group by department
order by sum(salary) desc

--33. Get department, no of employees in a department, total salary with respect to a
-- department from employee table order by total salary descending.
select department,count(emp_id),sum(salary)  from employee1
group by department
order by sum(salary)desc

select department, count(emp_id), sum(salary) from employee1
Group by department
order by sum(salary) desc


--34. Get department wise average salary from employee table order by salary ascending?
select department,avg(salary)as avg from employee1
group by department
order by avg asc

select department,avg(salary) from employee1
group by department
order by avg (salary)

--35. Get department wise maximum salary from employee table order by salary ascending?
select department,max(salary)as sal from employee1
group by department
order by sal asc


select department,max(salary) from employee1
group by department
order by max(salary)

--36. Get department wise minimum salary from employee table order by salary ascending?
select department,min(salary) from employee1
group by department
order by min (salary)asc

select department,min(salary) from employee1
group by department
order by min(salary)

--37. Select no of employees joined with respect to year and month from employee table.


--38. Select department,total salary with respect to a department from employee table 
--where total salary greater than 800000 order by Total_Salary descending
select department,sum(salary) from employee1
group by department
having sum (salary)>800000 
order by sum(salary) desc


--39. Select employee details from employee table if data in incentive table?
select * from incentives
select * from employee1 inner join incentives
on emp_id = employee_ref_id

--40. Select 20 % of salary from John, 10% of Salary for Roy and for other 15 % of salary
-- from employee table
select first_name ,salary,
case
  when first_name = 'John' then salary*20/100
    when first_name ='Roy' then salary*10/100
    else salary*15/100
      end
      from employee1

--41. Select Banking as 'Bank Dept', Insurance as 'Insurance Dept' and Services as
-- 'Services Dept' from employee table.
select first_name,department,
case
  when department = 'Banking' then 'Bank Dept'
    when department = 'Insurance' then 'Insurance Dept'
      when department = 'services' then 'Servies Dept'
        end as DEPTS
        from employee1

--42. Delete employee data from employee table who got incentives in incentive table

delete from employee1
where emp_id in( select distinct(employee_ref_id) from incentives)

delete from employee1
where emp_id in( select employee_ref_id from incentives) 


rollback

select * from employee1
select * from incentives
--43. Select first_name, incentive amount from employee and incentives table for those 
--employees who have incentives.
select e.first_name,i.incentive_amount from employee1 e inner join incentives i
on e.emp_id = i.employee_ref_id

select e.first_name, i.incentive_amount from employee1 e inner join incentives i
on e.emp_id = i.employee_ref_id

--44. Select first_name, incentive amount from employee and incentives table for those
-- employees who have incentives and incentive amount greater than 3000
select e.first_name,i.incentive_amount from employee1 e inner join incentives i
on e.emp_id = i.employee_ref_id
where i.incentive_amount > 3000

select * from employee1
select e.first_name, i.incentive_amount from employee1 e inner join incentives i
on e.emp_id = i.employee_ref_id
where incentive_amount>3000


--45. Select first_name, incentive amount from employee and incentives table for all 
--employees even if they didn't get incentives
select e.first_name, i.incentive_amount from employee1 e full outer join incentives i
on e.emp_id = i.employee_ref_id

select * from employee1
select * from incentives

select e.first_name, i.incentive_amount from employee1 e left outer join incentives i
on e.emp_id = i.employee_ref_id



--46. Select first_name, incentive amount from employee and incentives table for all 
--employees even if they didn't get incentives and set incentive amount as 0 for those 
--employees who didn't get incentives.
select e.first_name,nvl(i.incentive_amount,0)from employee1 e full outer join incentives i
on e.emp_id = i.employee_ref_id


select e.first_name,nvl(i.incentive_amount,0) from employee1 e left outer join incentives i
on e.emp_id = i.employee_ref_id

--47. Select first_name, incentive amount from employee and incentives table for all 
--employees who got incentives using left join
select e.first_name,i.incentive_amount from employee1 e left outer join incentives i
on e.emp_id = i.employee_ref_id
where incentive_amount is not null

select e.first_name, i.incentive_amount from employee1 e left join incentives i
on e.emp_id = i.employee_ref_id
where incentive_amount is not null

--48. Select max incentive with respect to employee from employee and incentives table

select first_name,emp_id from employee
where emp_id in(select employee_ref_id from incentives)


select e.first_name,max(i.incentive_amount) from employee1 e inner join incentives i
on e.emp_id = i.employee_ref_id
group by first_name
 
select e.emp_id , e.first_name, max(i.incentive_amount) from employee1 e inner join incentives i
on e.emp_id=i.employee_ref_id
group by e.emp_id,e.first_name


where emp_id in (select employee_ref_id from incentives)


select * from employee1
where emp_id in (select employee_ref_id from incentives)
having max(incentive_amount)
group by emp_id)

select max(incentive_amount) from incentives
where employee_ref_id in (select emp_id from employee1)

select * from employee1
where emp_id in (select employee_ref_id from incentives where
 (select max(incentive_amount) from incentives))





-----------------------
------------------------
-----------------------
--------------------------
---------------------------------
     EMP DEPT SALGRADE
------------------------
----------------------------------
--------------------------------------
---------------------------------
-----
-----
-----
----
---
--
---
----

-------------------------
--1.  Display all the information of the EMP table? 
select * from emp
select * from dept
select * from salgrade


--2.  Display unique Jobs from EMP table? 
select distinct(job) from emp

--3.  List the emps in the asc order of their Salaries?
select * from emp
order by sal asc 

select empno,ename,sal from emp
order by sal asc

--4.  List the details of the emps in asc order of the Dptnos and desc of Jobs? 
select * from emp
order by deptno asc , job desc

select * from emp
order by deptno asc, job desc

--5.  Display all the unique job groups in the descending order
select distinct(job) from emp
order by job desc 
select distinct(job) from emp
order by job desc

--6.  Display all the details of all ‘Mgrs’ 
select * from emp
where  job = 'MANAGER'

select * from emp
where job='MANAGER'

--7.  List the emps who joined before 1981.
select * from emp
where to_char(hiredate,'YYYY')<1981

select * from emp
where extract (year from (hiredate))<1981
  
--8.  List the Empno, Ename, Sal, Daily sal of all emps in the asc order of Annsal. 
select empno,ename,sal,(sal/30)as Daily_sal,(sal+sal*nvl(sal,0))*12 as ANNSAL from emp
order by ANNSAL asc

select * from emp
select empno,ename,sal,(sal + nvl(comm,0))/30 as Daily_sal,
(sal+nvl(comm,0))*12 as Annual_sal from emp
order by annual_sal asc

--9.  Display the Empno, Ename, job, Hiredate, Exp of all Mgrs 
select empno,ename,job,hiredate,(sysdate-hiredate)/12 as EXP from emp
where job = 'MANAGER'

select empno,ename,job,hiredate,(current_date - hiredate)/12 as exp from emp
where job='MANAGER'

select empno,ename,job,hiredate,extract(year from current_date) - extract (year from hiredate) as exp from emp
where job='MANAGER'v


--10. List the Empno, Ename, Sal, Exp of all emps working for Mgr 7369.
select empno,ename,sal,(current_date - hiredate)/12 from emp
where MGR = 7369 

select empno,ename,sal,mgr, extract(year from current_date)-extract(year from hiredate) as Total_EXP from emp
where mgr='7369'

select empno,ename,sal,to_char(hiredate)-to_char(sysdate) exp from emp
where mgr='7369'

select (sysdate-hiredate)/365 exp from emp
--11. Display all the details of the emps whose Comm. Is more than their Sal.
select * from emp
where comm>sal

select * from emp
where comm>sal

--12. List the emps in the asc order of Designations of those joined after 
--the second half of 1981. 
select * from emp
order by job asc
having haredate>to_date('01-jul-1981')


select * from emp
where hiredate>to_date('01-Jul-1981')
order by job asc

--13. List the emps along with their Exp and Daily Sal is more than Rs.100. 
select ename, extract(year from current_date)-extract(year from hiredate)as exp,(sal/30)  from emp
where (sal/30) > 100

select empno,sal,ename,job,extract (year from current_date)-extract (year from hiredate) as EXP,
(sal+nvl(comm,0))/30 As DAILY_SAL from emp
where (sal+nvl(comm,0))/30 >100

select empno,sal,ename,job,extract (year from current_date)-
extract (year from hiredate) as EXP,
(sal+nvl(comm,0))/30 As DAILY_SAL from emp
where (sal+nvl(comm,0))/30 >100


--14. List the emps who are either ‘CLERK’ or ‘ANALYST’ in the Desc order.
select * from emp
where job in('CLERK','ANALYST')
order by job desc

select * from emp
where job='CLERK' or job='ANALYST'
order by job desc
 
--15. List the emps who joined on 1-MAY-81,3-DEC-81,17-DEC-81,19-JAN-80 in asc order of 
--seniority. 
select * from emp
where hiredate in('01-May-81','03-dec-81','17-dec-81')
order by hiredate asc

select * from emp
where hiredate= '1-MAY-81'or hiredate='3-DEC-81' or hiredate= '17-DEC-81' or hiredate='19-JAN-80'
order by hiredate asc


--16. List the emp who are working for the Deptno 10 or20. 

select * from emp where  deptno in (10,20)

select * from emp
where deptno ='10' or deptno='20'

--17. List the emps who are joined in the year 81. 

select * from emp where extract(year from hiredate)=1981

select * from emp
where extract(year from hiredate)=1981

select * from emp
where to_char(hiredate,'yy')='81' 

--18. List the emps who are joined in the month of Aug 1980.
select * from emp where to_char(hiredate,'mon-yyyy') = 'Aug-1980'

select * from emp
where extract (year from hiredate)=1980
and extract (month from hiredate)= 08

--19. List the emps Who Annual sal ranging from 22000 and 45000.
select ename,sal,(sal+sal*nvl(comm,0))*12 as ANSAL from emp
where (sal+sal*nvl(comm,0))*12 between 22000 and 45000 

select ename,sal,(sal+nvl(comm,0))*12 as Annual_Sal from emp
where (sal+nvl(comm,0))*12 between 22000 and 45000
 
--20. List the Enames those are having five characters in their Names. 
select * from emp where length (ename) = 5

select * from emp
where ename like ('_____')

--21. List the Enames those are starting with ‘S’ and with five characters. 
select * from emp where ename like 'S___%'
select * from emp
where ename like ('S____')

--22. List the emps those are having four chars and third character must be ‘r’ngt. 
select * from emp where ename like ('__R_')
select * from emp
where ename like ('__R_')

--23. List the Five character names starting with ‘S’ and ending with ‘H’. 
select * from emp where ename like ('S___H')
select * from emp
where ename like('S___H')

--24. List the emps who joined in January. 
select * from emp where to_char(hiredate,'Mon') = 'Jan'
select * from emp where extract (month from hiredate) = '01'

select * from emp
where to_char(hiredate,'mon')='jan'

--25. List the emps whose Sal is four digit number ending with Zero. 
select * from emp where sal like ('___0')

select * from emp
where sal like ('___0')

--26. List the emps whose names having a character set ‘ll’ together. 
select * from emp where ename like ('%LL%')
select * from emp
where ename like '%LL%'

--28. List the emps those who joined in 80’s. 
select * from emp where to_char(hiredate,'YYYY')='1980'
select * from emp
where extract(year from hiredate)=1980

--29. List the emps who does not belong to Deptno 20. 
select * from emp where deptno <> 20
select * from emp
where deptno not in 20

--30. List all the emps except ‘PRESIDENT’ & ‘MGR’ in asc order of Salaries.
select * from emp where job not in ('PRESIDENT','MANAGER')
order by sal 

select * from emp
where job <> 'PRESIDENT' and job<>'MANAGER'
order by sal asc

--31. List all the emps who joined before or after 1981.
select * from emp where to_char(hiredate,'YYYY')<'1981'
or to_char(hiredate,'YYYY')>'1981'

select * from emp
where extract (year from hiredate)>1981  or extract (year from hiredate)<1981

--32. List the emps whose Empno not starting with digit78.
select * from emp where empno not like '78%'

select * from emp
where empno not like '78%' 

--33. List the emps who are working under ‘MGR’.
select * from emp where mgr is not null

select * From emp 
where mgr is not null

--34. List the emps who joined in any year but not belongs to the month of March.
select * from emp where to_char(hiredate,'Mon')<> 'March'
select * from emp
where extract(month from hiredate)<>3 

select * from emp
where to_char(hiredate,'mon')<>'Mar'

--35. List all the Clerks of Deptno 20.
select * from emp where deptno = 20 and job = 'CLERK' 
select * from emp
where job='CLERK' and deptno=20

--36. List the emps of Deptno 30 or 10 joined in the year 1981. 
select * from emp where deptno in(30,10) and extract (year from hiredate)='1981'
select * from emp
where deptno in(10,30) and extract (year from hiredate)=1981

--37. Display the details of SMITH. 
select * from emp where ename ='SMITH'
select * from emp
where ename='SMITH'

--38. Display the location of SMITH
select e.ename,d.loc from emp e inner join dept d
on e.deptno = d.deptno
where ename = 'SMITH'



select e.ename,d.LOC from dept d inner join emp e
on e.deptno=d.deptno where e.ename='SMITH'

select * from emp
select * from dept

--39. List the total information of EMP table along with DNAME and 
--Loc of all the emps Working Under ‘ACCOUNTING’ & ‘RESEARCH’ in the asc Deptno.
select e.*,d.dname,d.loc from emp e inner join dept d
on e.deptno = d.deptno
where d.dname in ('ACCOUNTING','RESEARCH')
order by d.deptno asc
 
select e.* ,d.dname from emp e inner join dept d
on e.deptno = d.deptno
where dname = 'ACCOUNTING' or dname = 'RESEARCH'

--40. List the Empno, Ename, Sal, Dname of all the ‘MGRS’ and ‘ANALYST’ 
--working in New York, Dallas with an exp more than 7 years without receiving the Comm asc
-- order of Loc.
select e.empno,e.ename,e.sal,e.hiredate, d.dname,d.loc from emp e inner join dept d
on e.deptno = d.deptno
where d.loc in ('NEW YORK','DALLAS') 
and e.job in ('MANAGER','ANALYST')
and (e.comm is null or e.comm =0)
and extract (year from sysdate) - extract(year from hiredate)>7


select e.empno, e.ename,e.sal,e.hiredate , d.dname,d.loc  from emp e inner join dept d
on e.deptno = d.deptno
where job in ('MANAGER','ANALYST') 
and loc in ('NEW YORK','DALLAS') 
and (e.comm is null or e.comm=0)
and (extract (year from sysdate) - extract(year from hiredate))>7

select * from emp
--41. Display the Empno, Ename, Sal, Dname, Loc, Deptno, Job of all emps working at CHICAGO 
--or working for ACCOUNTING dept with Ann Sal>28000, but the Sal should not be=3000 or 
--2800 who doesn’t belongs to the Mgr and whose no is having a digit ‘7’ or ‘8’ in 
--3rd position in the asc order of Deptno and desc order of job. 
select e.empno,e.ename,e.sal,e.deptno,e.mgr,e.job,d.dname,d.loc from emp e inner join dept d
on e.deptno = d.deptno
where d.loc = 'CHICAGO' or d.dname = 'ACCOUNTING'
and (sal+nvl(comm,0))*12 >28000
and mgr is not null
and empno like ('__7_') or empno like ('__8_')
order by deptno asc, job desc


select * from emp
--42. Display the total information of the emps along with Grades in the asc order. 
select * from emp
select * from dept
select * from salgrade
select * from bonus

select e.*,s.grade from emp e, salgrade s
where e.sal between s.losal and s.hisal
order by grade

select e.*,s.grade from emp e,salgrade s
where e.sal between s.losal and s.hisal
order by s.grade

--43. List all the Grade2 and Grade 3 emps. 
select * from salgrade
select * from emp
where (sal between 1201 and 1400) or (sal between 1401 and 2000)

select * from emp
where (sal between 1201 and 1400) or (sal between  1401 and 2000)


--44. Display all Grade 4,5 Analyst and Mgr.
select * from emp
where (sal between 2001 and 3000 ) or (sal between 3001 and 9999)
and job in ('ANALYST','MANAGER')

select * from emp
where job  ='ANALYST' or Job = 'MANAGER' 
and sal between 2001 and 9999
 
--45. List the Empno, Ename, Sal, Dname, Grade, Exp, and Ann Sal of emps working for
-- Dept10 or20.
select e.empno,e.ename,e.sal,d.dname,d.deptno,(e.sal+nvl(comm,0))*12 as annsal, 
extract(year from current_date)-extract (year from hiredate) as exp
from emp e inner join dept d on e.deptno = d.deptno
where e.deptno in (10,20)


 
--46. List all the information of emp with Loc and the Grade of all the emps belong 
--to the Grade range from 2 to 4 working at the Dept those are not starting with 
--char set ‘OP’ and not ending with ‘S’ with the designation having a char ‘a’ any 
--where joined in the year 1981 but not in the month of Mar or Sep and Sal not end 
--with ‘00’ in the asc order of Grades 

select e.*,d.loc,d.dname from emp e inner join dept d on e.deptno = d.deptno
where dname not like ('OP%')and dname not like ('%S')
and job like ('%A%')
and extract(year from hiredate)='1981'
and to_char(hiredate,'Mon')<> any('Mar','Sep')
and sal not like ('%00')

--47. List the details of the Depts along with Empno, Ename or without the emps 
select d.* , e.empno, e.ename from dept d inner join emp e
on d.deptno = e.deptno

--48. List the details of the emps whose Salaries more than the employee BLAKE.
select ename, sal from emp
where sal > (select sal from emp where ename='BLAKE')

 
select * from emp
where sal >(select sal from emp where ename = 'BLAKE')

--49. List the emps whose Jobs are same as ALLEN
select * from emp where job in (select job from emp where ename = 'ALLEN') 

select * from emp
where job = (select job from emp where ename = 'ALLEN')

--50. List the emps who are senior to King.
select * from emp where hiredate<(select hiredate from emp where ename ='KING')

select * from emp
where hiredate >(select hiredate from emp where ename= 'KING')
 
--51. List the Emps who are senior to their own MGRS. 

select e.empno,e.ename,m.empno mgrid,m.ename from emp e,emp m  where m.empno=e.mgr
and e.hiredate<m.hiredate

select * from emp
where 
select e.empno,e.ename,m.empno mgrid,m.ename from emp e,emp m where  m.empno=e.mgr 
and e.hiredate < m.hiredate

-- 52. List the Emps of Deptno 20 whose Jobs are same as Deptno10. 
select * from emp where deptno = 20 and 
job in (select job from emp where deptno = 10)

select * from emp where deptno = 20 and 
job in (select job from emp where deptno = 10)


--53. List the Emps whose Sal is same as FORD or SMITH in desc order of Sal.
select * from emp where sal in (select sal from emp where ename = 'FORD' or ename ='SMITH')
order by sal desc

select * from emp
where sal in (select sal from emp where ename = 'SMITH' or ename = 'FORD')
order by sal desc
 
--54. List the emps Whose Jobs are same as MILLER or Sal is more than ALLEN. 
select * from emp where job in (select job from emp where ename ='MILLER') 
or sal>(select sal from emp where ename ='ALLEN' )

select * from emp
where job in (select job from emp where ename ='MILLER') or
sal > (select sal from emp where ename = 'ALLEN')

--55. List the Emps whose Sal is > the total remuneration of the SALESMAN. 
select * from emp where sal>(select sum(sal)from emp where job = 'SALESMAN')

select * from emp
where sal >(select sum(sal) from emp where job='SALESMAN')

--56. List the emps who are senior to BLAKE working at CHICAGO & BOSTON.
select e.*,d.loc from emp e, dept d
where e.deptno = d.deptno and hiredate<(select hiredate from emp where ename = 'BLAKE')
and d.loc in ('CHICAGO','BOSTON')

select e.*, loc  from emp e, dept d
where e.deptno = d.deptno and  hiredate < 
(select hiredate from emp where ename ='BLAKE')
and loc in ('CHICAGO','BOSTON')


select decode(null,1,2,3,null,6,null,null,5,6,1) from dual 

select decode(null,1,2,3) from dual

--57. List the Emps of Grade 3,4 belongs to the dept ACCOUNTING and RESEARCH 
--whose Sal is more than ALLEN and exp more than SMITH in the asc order of EXP. 
select * from
(select e.* from emp e,dept d where e.deptno = d.deptno and dname in ('ACCOUNTING','RESEARCH')
and sal >(select Sal from emp where ename = 'ALLEN') 
and hiredate<(select hiredate from emp where ename = 'SMITH')),salgrade
where grade in (3,4)


select * from (select e.* from emp e,dept d where e.deptno=d.deptno and dname in('ACCOUNTING','RESEARCH')
and sal>(select sal from emp where ename='ALLEN') and hiredate<
(select hiredate from emp where ename='SMITH')),salgrade
where grade in(3,4)

--58. List the emps whose jobs same as SMITH or ALLEN. 
select * from emp where job in (select job from emp where ename in('SMITH','ALLEN'))

select * from emp
where job in (select job from emp where ename in('SMITH','ALLEN'))

--59. Write a Query to display the details of emps whose Sal is same as of
select * from emp 

--60. Any jobs of deptno 10 those that are not found in deptno 20.
select * from emp 
where job in(select job from emp where deptno= 10)
and  job not in (select job from emp where deptno =20)

select * from emp
where job in (select job from emp where deptno = 10)
and job not in(select job from emp where deptno = 20)

select job from emp where deptno=10
minus
select job from emp where deptno=20


--61. List of emps of emp1 who are not found in emp2. 
NA


--62. Find the highest sal of EMP table.
select max(sal) from emp
select Max(sal) from emp 

select * from emp
where sal in (select max(sal) from emp)

--63. Find details of highest paid employee.
select * from emp where sal in (select max(sal) from emp)
 
select * from emp
where sal in (select max( sal + nvl(comm,0)) from emp)

--64. Find the highest paid employee of sales Dt epartment.
select ename,max(sal) from emp 

select e.ename,e.job,max(e.sal),d.dname from emp e, dept d where e.deptno = d.deptno
and  d.dname like '%SALES%'
group by d.dname,e.ename,e.job

select e.ename,max(e.sal),d.dname from emp e, dept d where e.deptno = d.deptno
and d.dname in(select dname from dept where dname in('SALES'))
group by e.ename,d.dname

select ename, deptno ,empno,max(sal) from emp
where deptno in(select deptno from dept where dname = 'SALES')
group by ename,deptno,empno

--65. List the most recently hired emp of grade3 belongs to location CHICAGO. 

select e.*,d.loc from emp e,dept d where e.deptno = d.deptno
and  hiredate in (select max(hiredate) from emp where d.loc = 'CHICAGO')

select * from emp e
join dept d on e.deptno=d.deptno and d.loc='CHICAGO'
join salgrade s on e.sal between losal and hisal 
where s.grade=3
and rownum=1
order by hiredate desc;
 
select * from emp;
select * from salgrade;
select * from dept;
select * from (select e.*,loc from emp e,dept d
where e.deptno=d.deptno and loc='CHICAGO' and 
hiredate in(select max(hiredate)from emp group by deptno)),salgrade 
where grade=3

--66. List the employees who are senior to most recently hired employee working under king.
select e.empno,e.ename,m.empno as mgrid, m.ename from emp e,emp m
where m.mgr = e.empno
and hiredate <(select hiredate from from emp where  

select e.empno,e.ename,m.empno mgrid,m.ename mname from emp e,emp m
where e.mgr=m.empno
select * from salgrade
--67. List the details of the employee belongs to newyork with grade 3 to 5 except 
--‘PRESIDENT’ whose sal> the highest paid employee of Chicago in a group where there
-- is manager and salesman not working under king 
select e.*,d.loc from emp e, dept d where e.deptno = d.deptno
and loc = 'NEW YORK' 
and e.sal > (select max(sal) from emp where loc = 'CHICAGO')

--68. List the details of the senior employee belongs to 1981.
select * from emp
where extract (year from (hiredate))=1981


select * from emp 
where extract (year from (hiredate))='1981'
and hiredate in (select max(hiredate) from emp)
 
select * from emp
where to_char(hiredate,'YYYY') in (select to_char (hiredate,'1981')from emp)

select * from emp
where hiredate <(select hiredate from emp where   

select * from emp
where extract (year from hiredate) = '1981'

select * from emp
where extract (year from hiredate) = '1981'
and hiredate in( select to_char min('hiredate','YYYY')) from emp


select * from emp
where hiredate in(select min('hiredate') from emp)
extract (year from hiredate) = '1981' 


--69. List the employees who joined in 1981 with the job same as the most 
--senior person of the year 1981. 

select * from emp where to_char(hiredate,'YYYY')='1981'
and job = (select job from emp where ename = 'ALLEN')
order by hiredate 


--70. List the most senior empl working under the king and grade is more than 3. 
select emp1.*,grade from (select * from emp
where mgr = (select empno from emp where ename= 'KING') and
hiredate in (select min(hiredate) from emp group by mgr)) emp1,salgrade
where grade>3

select * from salgrade

--71. Find the total sal given to the MGR. 
select job,sum(sal) from emp
where job = 'MANAGER'
group by job

select job,sum(sal) from emp
where job = 'MANAGER'
group by job

--72. Find the total annual sal to distribute job wise in the year 81.
select job,sum(sal)*12 as ANNSAL from emp
where extract (year from hiredate)='1981' 
group by job

select job,sum(sal)*12 from emp
where extract (year from hiredate)=1981
group by job


--73. Display total sal employee belonging to grade 3. 
select sum(e.sal),s.grade from emp e,salgrade s
where s.grade = 3
group by grade

--74. Display the average salaries of all the clerks. 
select avg(sal),job from emp where job like '%CLERK%'
group by job

select job, avg(sal) from emp
group by job

--75. List the employee in dept 20 whose sal is >the average sal 0f dept 10 emps.
select * from emp where deptno = '20' 
and sal > (select avg(sal) from emp where deptno ='10')

---

--76. Display the number of employee for each job group deptno wise.
select count(empno ),job from emp
group by job

select count(ename),job,deptno from emp
group by deptno,job

--77. List the manager no and the number of employees working for those mgrs in the 
--ascending Mgrno.
select mgr,count(empno) from emp
group by mgr
order by mgr



select mgr,count(empno) from emp
group by mgr
order by mgr


--78. List the department details where at least two emps are working
select count(e.ename),d.dname from emp e,dept d
where e.deptno = d.deptno
group by d.dname
having count(e.ename)>=2

select count(e.ename),d.deptno, d.dname from emp e inner join dept d
on e.deptno = d.deptno 
group by d.dname,d.deptno
having count(e.ename)>=2

select * from salgrade

--79. Display the Grade, Number of emps, and max sal of each grade.
 
select s.grade, count(e.empno),max(e.sal)from salgrade s,emp e
group by grade


--80. Display dname, grade, No. of emps where at least two emps are clerks. 



--81. List the details of the department where maximum number of emps are working.
select d.deptno,d.dname, count(e.empno) as xx from emp e inner join dept d
on e.deptno = d.deptno
group by d.deptno,d.dname

 

select d.dname,d.loc ,e.deptno,(count(e.ename)) from dept d inner join emp e
on d.deptno  = e.deptno
group by d.dname,d.loc,e.dept




--82. Display the emps whose manager name is jones.
select * from emp where mgr in (select empno from emp where ename ='JONES')
 
select * from emp where mgr in (select empno from emp where ename = 'JONES')


--83. List the employees whose salary is more than 3000 after giving 20% increment.

select * from emp
where sal in (select (sal+sal*20/100) from emp )


select * from emp
where sal in (select (sal+sal*20%) from emp )

--84. List the emps with dept names.
select e.ename, d.dname from emp e, dept d
where e.deptno = d.deptno  


select e.ename , d.dname from emp e inner join dept d
on e.deptno = d.deptno

--85. List the emps who are not working in sales dept.
select e.ename ,d.dname from emp e,dept d
where e.deptno = d.deptno
and dname not like '%SALES%'

select e.ename , d.dname from emp e inner join dept d
on e.deptno = d.deptno
where dname = 'SALES'

--86. List the emps name ,dept, sal and comm. For those whose salary is between 2000
-- and 5000 while loc is Chicago. 

select e.ename,d.dname,e.sal,e.comm,d.loc from emp e,dept d
where e.deptno = d.deptno
and sal between 2000 and 5000
and d.loc = 'CHICAGO'


--87. List the emps whose sal is greater than his managers salary 
select e.empno,e.ename,e.sal as empsal ,m.empno as MANAGERID, m.sal as mansal
from emp e,emp m
where e.mgr = m.empno
and e.sal > m.sal

select e.empno,e.ename,m.empno mgrid ,m.sal mgrsal,e.sal empsal from emp e join emp m
on e.mgr = m.empno 
where e.sal>m.sal

--88. List the grade, EMP name for the deptno 10 or deptno 30 but sal grade is not 4 
--while they joined the company before ’31-dec-82’. 

select s.grade,e.ename,e.deptno from emp e,salgrade s
where deptno in ('10','30')
and grade <> 4
and hiredate < '31-dec-1982'


--89. List the name ,job, dname, location for those who are working as MGRS. 

select e.ename,e.job,d.dname,d.loc from emp e,dept d
where e.deptno = d.deptno
and job like '%MANAGER%'

select * from emp
select * from dept

select ename,job,dname,loc from emp e ,dept d
where e.deptno = d.deptno


--90. List the emps whose mgr name is jones and also list their manager name. 
select * from emp where mgr in(select empno from emp where ename ='JONES')

select e.*,m.ename as MANNAME from emp e,emp m
where e.mgr = m.empno
and m.ename like '%JONES%'

select * from emp where mgr =(select empno from emp where ename = 'JONES')

select e.empno,e.ename,m.empno MGRNo,m.ename MGRNAME from emp e join emp m
on e.mgr = m.empno
where m.ename = 'JONES'


--91. List the name and salary of ford if his salary is equal to hisal of his grade. 

select e.ename,e.sal,s.hisal from emp e,salgrade s
where e.sal = s.hisal
and ename ='FORD'


--92. List the name, job, dname ,sal, grade dept wise 
select e.ename,e.job,d.dname,e.sal,s.grade from emp e,dept d,salgrade s
xx
select *,from(
select ename, job, sal, dname, d.deptno from emp e,dept d
where e.deptno=d.deptno order by d.deptno)
 
--93. List the emp name, job, sal, grade and dname except clerks 
--and sort on the basis of highest sal.
 select e.ename,e.job,d.dname, e.sal,s.grade from emp e,dept d,salgrade s
 where job <> 'CLERK'
 order by e.sal desc

select e.ename,e.job,e.sal,d.dname from emp e, dept d
where e.deptno = d.deptno

--94. List the emps name, job who are with out manager. 
select ename,job,mgr from emp where mgr is null

select ename,job from emp where mgr is null

--95. List the names of the emps who are getting the highest sal dept wise. 
select * from (select ename,job, deptno, sal , 
row_number()over(partition by deptno order by sal desc)rn from emp)
where rn = 1 

--96. List the emps whose sal is equal to the average of max and minimum 
XX
select * from emp
where sal=(select avg(sal) from
(select max(sal) sal from emp
union
select min(sal) from emp))






--97. List the names of depts. Where atleast 3 are working in that department.
select d.dname,count(e.empno) from emp e inner join dept d
on e.deptno = d.deptno 
group by d.dname
having count (e.empno)>=3

select count(e.empno),d.deptno,d.dname from emp e inner join dept d
on e.deptno = d.deptno
group by d.deptno,d.dname
having count(empno)>=3

--98. List the managers whose sal is more than his employess avg salary.
select e.empno,e.ename,e.sal,m.empno as MGRNO ,m.ename,m.sal from emp e,emp m
where e.mgr = m.empno
and m.sal > (select avg (e.sal ) from emp)


--101.  List the emp whose sal<his manager but more than any other manager. 
select e.empno,e.ename,e.sal,m.empno as MGRNO ,m.ename as MNAME,m.sal as MANSAL from emp e,emp m
where e.mgr = m.empno
and e.sal<m.sal
and e.sal > (select min(sal)from emp where job ='MANAGER')

select * from emp
--102. List the employee names and his average salary department wise.
select ename,avg(sal), deptno from (select ename,sal, deptno,
row_number()over (partition by deptno order by sal) from emp)
group by ename,deptno
order by deptno

select ename,avg(sal),deptno from emp
group by ename,deptno

--103.  Find out least 5 earners of the company. 
select empno,sal,deptno,
row_number()over (partition by deptno order by sal desc)rn from emp

--104.  Find out emps whose salaries greater than salaries of their managers. 
select e.ename,e.sal,e.empno,m.ename MNAME ,m.sal MSAL,m.empno MNUM from emp e join emp m
on e.mgr = m.empno
where e.sal > m.sal


--105.  List the managers who are not working under the president.
select * from emp where job ='MANAGER' 
and 
mgr not in (select empno from emp where job = 'PRESIDENT')

select * from emp
where job ='MANAGER' and mgr not in(select empno from emp where job = 'PRESIDENT')

-- 106.  List the records from emp whose deptno isnot in dept. 
select * from emp
where deptno not in(select deptno from dept)

--107.  List the Name , Salary, Comm and Net Pay is more than any other employee. 
select ename,sal,comm from emp
where (sal+nvl(comm,0))=(select max(sal+nvl(comm,0)) from emp)

--108.  List the Enames who are retiring after 31-Dec-89 the max Job period is 20Y

XX
select ename,hiredate from emp where to_char(hiredate,'YY' )in 
(select to_char (hiredate,'YY')+20 from emp)

--109.  List those Emps whose Salary is odd value. 

select * from emp
where mod(sal,2)=1

select * from emp
where mod(sal,2)=1

--110.  List the emp’s whose Salary contain 3 digits. 
select * from emp where length(sal)=3

select * from emp
where sal like ('___')

--111.  List the emps who joined in the month of DEC. 
select * from emp where to_char (hiredate ,'Mon')='Dec'
select * from emp
where to_char(hiredate,'Mon') = 'Dec'


--112.  List the emps whose names contains ‘A’.
select * from emp where ename like '%A%'
select * from emp
where ename like '%A%'
 
--113.  List the emps whose Deptno is available in his Salary. 
select * from emp where deptno in (select sal from emp)

select * from emp
where sal like '%deptno%'

select * from emp
where sal in(select sal from emp where sal like '%deptno%')

--114.  List the emps whose first 2 chars from Hiredate=last 2 characters of Salary. 
select * from emp where to_char(hiredate,'DD') = substr(sal,-2,2)

--115.  List the emps Whose 10% of Salary is equal to year of joining.
select * from emp
where extract(year from hiredate) in(select round((sal/100)*10) from emp)
 
--116.  List first 50% of chars of Ename in Lower Case and remaining are upper Case. 
select upper(ename)
select upper(substr(ename,1,3))|| lower(substr(ename,4,6))from emp

--117.  List the Dname whose No. of Emps is =to number of chars in the Dname. 
select job,count(empno) from emp
group by job
having length(job) = count(empno) 

--118.  List the emps those who joined in company before 15th of the month. 

select * from emp
where extract (day from hiredate)<15




--119.  List the Dname, no of chars of which is = no. of emp’s in any other Dept. 

--120.  List the emps who are working as Managers. 
select * from emp
where job = 'MANAGER'

--121.  List THE Name of dept where highest no.of emps are working.

 select * from (select d.dname,count(e.ename) as tc from emp e,dept d
 where e.deptno = d.deptno
 group by d.dname
 order by tc desc)
 where rownum = 1
 
select * from(select d.dname,count(e.ename) tc from emp e inner join dept d
on e.deptno = d.deptno
group by d.dname
order by tc desc)
where rownum=1
 not solved by me

--122. Count the No.of emps who are working as ‘Managers’(using set option).

--123.  List the emps who joined in the company on the same date. 
select e.ename,e.hiredate,m.ename,m.hiredate from emp e,emp m
where e.hiredate = m.hiredat

select * from emp where hiredate in 
(select hiredate from (
select count(empno),hiredate from emp
group by hiredate ))


--124.  List the details of the emps whose Grade is equal to one tenth of Sales Dept. 
--125.  List the name of the dept where more than average no. of emps are working. 

126.  List the Managers name who is having max no.of emps working under him. 

127.  List the Ename and Sal is increased by 15% and expressed as no.of Dollars. 

128.  Produce the output of EMP table ‘EMP_AND_JOB’ for Ename and Job. 
129.  Produce the following output from EMP. 
EMPLOYEE
SMITH (clerk)
ALLEN (Salesman)

select ename||' '||'('||job||')' employee from emp

--130)  List the emps with Hire date in format June 4, 1988. 
select ename,empno,to_char(hiredate,'month-dd-yyyy') from emp

--131)  Print a list of emp’s Listing ‘just salary’ if Salary is more than 1500, 
--on target if Salary is 1500 and ‘Below 1500’ if Salary is less than 1500. 




--132)  Write a query which return the day of the week for any date entered 
--in format ‘DD-MM-YY’. 



--133)  Write a query to calculate the length of service of any employee with the company,
-- use DEFINE to avoid repetitive typing of functions. 


--134)  Give a string of format ‘NN/NN’, verify that the first and last two characters
-- are numbers and that the middle character is’/’. Print the expression ‘YES’ if valid,
-- ‘NO’ if not valid. Use the following values to test your solution. 
--‘12/34’,’01/1a’, ‘99/98’. 

--135)  Emps hired on or before 15th of any month are paid on the last Friday of that month
-- those hired after 15th are paid on the first Friday of the following month. 
--Print a list of emps their hire date and the first pay date. Sort on hire date. 

--136)  Count the no. of characters with out considering spaces for each name. 


1373)  Find out the emps who are getting decimal value in their Sal without using like operator. 
138)  List those emps whose Salary contains first four digit of their Deptno. 
 
139)  List those Managers who are getting less than his emps Salary. 
140)  Print the details of all the emps who are sub-ordinates to Blake. 
141)  List the emps who are working as Managers using co-related sub-query. 
142)  List the emps whose Mgr name is ‘Jones’ and also with his Manager name. 
143)  Define a variable representing the expression used to calculate on emps total annual remuneration use the variable in a statement, which finds all emps who can earn 30000 a year or more. 
144)  Find out how may Managers are their in the company. 
145)  Find Average salary and Average total remuneration for each Job type. Remember Salesman earn commission.secommm 
146)  Check whether all the emps numbers are indeed unique. 
147)  List the emps who are drawing less than 1000 Sort the output by Salary.  
148)  List the employee Name, Job, Annual Salary, deptno, Dept name and grade who earn 36000 a year or who are not CLERKS. 
149)  Find out the Job that was filled in the first half of 1983 and same job that was filled during the same period of 1984. 
150)  Find out the emps who joined in the company before their Managers. 
151)  List all the emps by name and number along with their Manager’s name and number. Also List KING who has no ‘Manager’. 


--152)  Find all the emps who earn the minimum Salary for each job wise in ascending order. 

select * from(select employee_id,first_name,department_id,salary,
rank() over (partition by department_id order by salary desc) rn from hr.employees)
where rn=2

select * from( select ename,job,sal,
rank() over (partition by job order by sal) rn from emp)
where rn=1

--153)  Find out all the emps who earn highest salary in each job type.
-- Sort in descending salary order. 
select * from (select ename, job, sal,
rank () over(partition by job order by sal desc) rn from emp)
where rn= 1
order by sal desc

154)  Find out the most recently hired emps in each Dept order by Hiredate. 
155)  List the employee name,Salary and Deptno for each employee who earns a salary greater than the average for their department order by Deptno. 
156)  List the Deptno where there are no emps. 
157)  List the No.of emp’s and Avg salary within each department for each job. 
158)  Find the maximum average salary drawn for each job except for ‘President’. 
159)  Find the n ame and Job of the emps who earn Max salary and Commission. 
160)  List the Name, Job and Salary of the emps who are not belonging to the department 10 but who have the same job and Salary as the emps of dept 10. 
161)  List the Deptno, Name, Job, Salary and Sal+Comm of the SALESMAN who are 
earning maximum salary and commission in descending order.
162)  List the Deptno, Name, Job, Salary and Sal+Comm of the emps who earn the second highest earnings (sal + comm.).
163)  List the Deptno and their average salaries for dept with the average salary less than the averages for all department 
164)  List out the Names and Salaries of the emps along with their manager names and salaries for those emps who earn more salary than their Manager. 
--165)  List out the Name, Job, Salary of the emps in the department with the highest
 --average salary 



--166) List the empno,sal,comm. Of emps.
select empno,sal , comm from emp

--167)  List the details of the emps in the ascending order of the sal. 
select * from emp
order by sal 

--168)  List the dept in the ascending order of the job and the desc order of the emps print empno, ename. 


--169)  Display the unique dept of the emps. 
select distinct (deptno) from emp


--170)  Display the unique dept with jobs. 
select distinct(deptno), job from emp

--171)  Display the details of the blake. 
select * from emp where ename ='BLAKE'

--172)  List all the clerks. 
select * from emp where job = 'CLERK'


--173)  list all the employees joined on 1st may 81. 
select * from emp
where hiredate= '01-may-1981'

--174)  List the empno,ename,sal,deptno of the dept 10 emps in the ascending order of salary.
select empno,ename,sal,deptno from emp
where deptno = 10
order by sal


--175)  List the emps whose salaries are less than 3500. 
select * from emp
where sal <3500
select empno,ename,sal from emp

--176)  List the empno,ename,sal of all the emp joined before 1 apr 81. 
where to_char(hiredate,dd-mon-year)> '1-apr-81'



--177)  List the emp whose annual sal is <25000 in the asc order of the salaries. 
select ename, sal ,sal*12 annual_sal from emp
where sal*12 <25000
order by annual_sal

--178)  List the empno,ename,annsal,dailysal of all the salesmen in the asc  ann sal 
select empno,ename,sal*12 as Annsal, round(sal/30) as dailysal from emp
where job = 'SALESMAN'
order by annsal asc  

--179)  List the empno,ename,hiredate,current date & exp in the ascending order of the exp. 
select empno,ename,hiredate,current_date , sal*12,round(sal/30),
extract(year from sysdate) - extract(year from hiredate) as exp from emp
 order by exp


--180)  List the emps whose exp is more than 10 years. 
select * from emp
where extract(year from sysdate) - extract (year from hiredate) > 10


--181)  List the empno,ename,sal,TA30%,DA 40%,HRA 50%,GROSS,LIC,PF,net,deduction,net allow and net sal in the ascending order of the net salary. 


--182)  List the emps who are working as managers. 
select * from emp 
where job = 'MANAGER'

--183)  List the emps who are either clerks or managers. 
select * from emp
where job in('CLERK','MANAGER')

--184)  List the emps who have joined on the following dates 1 may 81,17 nov 81,30 dec 81 
--
--185)  List the emps who have joined in the year 1981. 
select * from emp
where extract(year from hiredate) = 1981
--
--186)  List the emps whose annual sal ranging from 23000 to 40000. 
select * from emp
where sal*12 between 23000 and 40000



--187)  List the emps working under the mgrs 7369,7890,7654,7900. 
select * from emp
where mgr in(7369,7890,7654,7900)

--188)  List the emps who joined in the second half of 82. 


--189)  List all the 4char emps. 
select * from emp where ename like '____'

--190)  List the emps end with ‘H’ all together 5 chars. 
select * from emp where ename like '____H'

--191)  List names start with ‘M’. 
select * from emp where ename like 'M%'

--192)  List the emps who joined in the year 81. 
select * from emp
where to_char(hiredate,'yy')=81

--193)  List the emps whose sal is ending with 00. 
select * from emp
where sal like '%00'


--194)  List the emp who joined in the month of JAN.
select * from emp
where extract (month from hiredate) = 01 

--195)  Who joined in the month having char ‘a’.
select ename , hiredate from emp 
where to_char(hiredate,'Month') like 'A%'

--196)  Who joined in the month having second char ‘a’ 

select ename , hiredate from emp 
where to_char(hiredate,'Month') like '_a%'

--197)  List the emps whose salary is 4 digit number. 
regular expression

select * from emp
where sal like '____'



--198)  List the emp who joined in 80’s. 
select * from emp
where extract (year from hiredate)=1980

--200)  List the emp who are clerks who have exp more than 8ys.
select ename,empno from emp where job = 'CLERK'
and (to_char(sysdate,'yyyy')-to_char(hiredate,'yyyy'))>8

select * from emp where job = 'CLERK'
and (to_char(sysdate,'yyyy')-to_char(hiredate,'yyyy'))>8

 
--201)  List the mgrs of dept 10 or 20.
select * from emp 
where job = 'MANAGER' and deptno in (10,20)

--202)  List the emps joined in jan with salary ranging from 1500 to 4000. 
select * from emp
where extract (month from hiredate)=01
and sal between 1500 and 4000

--203)  List the unique jobs of dept 20 and 30 in desc order.
select distinct (job) from emp
where deptno in(20,30)
order by job desc 

--204)  List the emps along with exp of those working under the mgr whose number is 
--starting with 7 but should not have a 9 joined before 1983.
 
--205)  List the emps who are working as either mgr or analyst with the salary ranging
-- from 2000 to 5000 and with out comm. 
select * from emp
where job in('MANAGER','ANALYST') and sal between 2000 and 5000
and comm is null

--206)  List the empno,ename,sal,job of the emps with /ann sal <34000 but receiving 
--some comm. Which should not be>sal and desg should be sales man working for dept 30.
select empno,ename,sal,job,sal from emp
where sal < select (sal+(nvl(comm,0)))*12 from emp

--207)  List the emps who are working for dept 10 or 20 with desgs as clerk or analyst with a sal is either 3 or 4 digits with an exp>8ys but does not belong to mons of 
--mar,apr,sep and working for mgrs &no is not ending with 88 and 56. 

--208)  List the empno,ename,sal,job,deptno&exp of all the emps belongs to dept 10 or 20 
--with an exp 6 to 10 y working under the same mgr with out comm.
-- With a job not ending irrespective of the position with comm.>200 with exp>=7y and 
--sal<2500 but not belongs to the month sep or nov working under the mgr whose no is not 
--having digits either 9 or 0 in the asc dept& desc dept 

--209)  List the details of the emps working at Chicago. 
select e.* , d.loc from emp e inner join dept d
on e.deptno = d.deptno
where d.loc in(select loc from dept where loc = 'CHICAGO')


--210)  List the empno,ename,deptno,loc of all the emps. 
select e.empno,e.ename,e.deptno, d.loc from emp e inner join dept d
on e.deptno = d.deptno

--211)  List the empno,ename,loc,dname of all the depts.,10 and 20.
select empno,ename,loc,dname from emp inner join dept
on emp.deptno = dept.deptno
where emp.deptno in(10,20)

--212)  List the empno, ename, sal, loc of the emps working at Chicago dallas with an exp>6ys. 


--213)  List the empDs along with loc of those who belongs to dallas ,newyork with sal ranging from 2000 to 5000 joined in 81. 


--214)  List the empno,ename,sal,grade of all emps. 
select * from(select ename , empno, sal, grade from emp , salgrade ) rn
where rowid not in(select max(rowid) from group by empno)
---
--215)  List the grade 2 and 3 emp of Chicago. 
select * from (select e.ename,d.loc from emp e inner join dept d
on e.deptno = d.deptno
where d.loc = 'CHICAGO'),salgrade
where grade in (2,3)
 
XX
--216)  List the emps with loc and grade of accounting dept or the locs dallas or Chicago with the grades 3 to 5 &exp >6y 


--217) List the grades 3 emps of research and operations depts.. 
--joined after 1987 and whose names should not be either miller or allen.

--218)  List the emps whose job is same as smith. 
select * from emp
where job in(select job from emp where ename = 'SMITH')

--219)  List the emps who are senior to miller. 
select * from emp
where hiredate<(select hiredate from emp where ename = 'MILLER')

--220)  List the emps whose job is same as either allen or sal>allen.
select * from emp
where job = (select job from emp where ename = 'ALLEN')
 or sal > (select sal from emp where ename = 'ALLEN')

--221)  List the emps who are senior to their own manager. 

--222)  List the emps whose sal greater than blakes sal.
select * from emp
where sal >(select sal from emp where ename = 'BLAKE') 

--223)  List the dept 10 emps whose sal>allen sal. 
select * from emp where deptno = 10 and sal > (select sal from emp where ename = 'ALLEN')

--224)  List the mgrs who are senior to king and who are junior to smith. 


--225)   List the empno,ename,loc,sal,dname,loc of the all the emps belonging to king dept.

select e.empno,e.ename,e.sal,d.dname, d.loc from emp e inner join dept d
on e.deptno = d.deptno
where dname in (select dname from dept where )
------
select * from salgrade

--226)  List the emps whose salgrade are greater than the grade of miller. 

--227)  List the emps who are belonging dallas or Chicago with the grade same as adamsor exp more than smith. 

--228)  List the emps whose sal is same as ford or blake. 
select * from emp
where sal in(select sal from emp where ename in('FORD','BLAKE'))

--229)  List the emps whose sal is same as any one of the following. 
NA

--230)  Sal of any clerk of emp1 table.
NA 

--231)  Any emp of emp2 joined before 82. 
NA

--232)  The total remuneration (sal+comm.) of all sales person of Sales dept 
--belonging to emp3 table. 
NA

--233)  Any Grade 4 emps Sal of emp 4 table. 
NA

--234)  Any emp Sal of emp5 table. 
NA

--235)  List the highest paid emp. 
select * from emp
where sal in (select Max(sal) from emp)

--236)  List the details of most recently hired emp of dept 30. 
select * from emp 
where deptno = 30
order by hiredate desc

--237)  List the highest paid emp of Chicago joined before the most recently hired emp
-- of grade 2.

select * from emp where sal in(select max(sal)from emp)

select e.ename,e.hiredate,max(e.sal),d.loc from emp e inner join dept d
on e.deptno=d.deptno
where d.loc='CHICAGO'
group by ename,loc,e.hiredate
having rowid =1
 

--238)  List the highest paid emp working under king.
select * from emp where sal in 
(select max (sal)from emp where mgr in (select empno from emp where ename='KING'))
 
select deptno, max(sal)from emp where
mgr in (select empno from emp where ename='KING')
group by deptno


select ename,max(sal)from(
select e.ename,e.empno,e.sal,m.empno as mgrid,m.ename as manname from emp e,emp m
where e.mgr = m.empno)
where manname ='KING'
group by ename


------------
----------
----------
--------------
------
------
-----
----
---
-

---
---
----
-----
----

 --SQL QUERIES SHARED BY AKASH
 =-----
 ----
 .---
 ---
 ---
 --
 -
 ---
 ---
 ---
 ---
 --
 --
 --
 --
 --
 --
 --
 --
 
 
--1) Display the details of all employees
    SQL>Select * from emp;
 
--2) Display the depart information from department table
    SQL>select * from dept;
 
--3) Display the name and job for all the employees
    SQL>select ename,job from emp;
 
4)-- Display the name and salary  for all the employees
    SQL>select ename,sal from emp;
 
5) --Display the employee no and totalsalary  for all the employees
    SQL>select empno,ename,sal,comm, sal+nvl(comm,0) as"total  salary" from
    emp
 
6) --Display the employee name and annual salary for all employees.
    SQL>select ename, 12*(sal+nvl(comm,0)) as "annual Sal" from emp
 
7) --Dsplay the names of all the employees who are working in depart number 10.
    SQL>select emame from emp where deptno=10;
 
8) --Display the names of all the employees who are working as clerks and
   --drawing a salary more than 3000.
   SQL>select ename from emp where job='CLERK' and sal>3000;
 
9) Display the employee number and name  who are earning comm.
   SQL>select empno,ename from emp where comm is not null;
s
10) Display the employee number and name  who do not earn any comm.
SQL>select empno,ename from emp where comm is null;
 
11) Display the names of employees who are working as clerks,salesman or
analyst and drawing a salary more than 3000.
SQL>select ename  from emp where job='CLERK' OR JOB='SALESMAN'
          OR JOB='ANALYST' AND SAL>3000;
 
12) Display the names of the employees who are working in the company for
the past 5 years;
SQL>select ename  from emp where to_char(sysdate,'YYYY')-to_char(hiredate,'YYYY')>=5;
 
13) Display the list of employees who have joined the company before
30-JUN-90 or after 31-DEC-90.
a)select ename from emp where hiredate < '30-JUN-1990' or hiredate >
'31-DEC-90';
 
14) Display current Date.
SQL>select sysdate from dual;
 
--15) Display the list of all users in your database(use catalog table).
select username from all_users;
 
--16) Display the names of all tables from current user;
select tname from tab;
 select * from todkar
delete todkar
--17) Display the name of the current user.
show user
 
18) Display the names of employees working in depart number 10 or 20 or 40
or employees working as
CLERKS, SALESMAN or ANALYST.
SQL>select ename from emp where deptno in (10, 20, 40) or job
in ('CLERKS','SALESMAN','ANALYST');
 
19) Display the names of employees whose name starts with alphabet S.
SQL>select ename from emp where ename like 'S%';
 
20) Display the Employee names for employees whose name ends with alphabet S.
SQL>select ename from emp where ename like '%S';
 
21) Display the names of employees whose names have second alphabet A in
their names.
SQL>select ename from emp where ename like '_A%';
 
22) select the names of the employee whose names is exactly five characters
in length.
SQL>select ename from emp where length (ename) =5;
 
23) Display the names of the employee who ar e not working as MANAGERS.
SQL>select ename from emp where job not in ('MANAGER');
 
24) Display the names of the employee who are not work ing as SALESMAN OR
CLERK OR ANALYST.
SQL>select ename from EMP where job not
In ('SALESMAN','CLERK','ANALYST');
 
25) Display all rows from EMP table. The system should wait after every
Screen full of information.
SQL>set pause on
 
26) Display the total number of employee working in the company.
SQL>select count (*) from emp;
 
27) Display the total salary beiging paid to all employees.
SQL>select sum (Sal) from emp;
 
28) Display the maximum salary from emp table.
SQL>select max (Sal) from emp;
 
29) Display the minimum salary from emp table.
K SQL>select min (Sal) from emp;
 
30) Display the average salary from emp table.
SQL>select avg(sal) from emp;
 
31) Display the maximum salary being paid to CLERK.
SQL>select max(sal) from emp where job='CLERK';
 
32) Display the maximum salary being paid to depart number 20.
SQL>select max(sal) from emp where deptno=20;
 
33) Display the minimum salary being paid to any SALESMAN.
SQL>select min(sal) from emp where job='SALESMAN';
 
34) Display the average salary drawn by MANAGERS.
SQL>select avg(sal) from emp where job='MANAGER';
 
35) Display the total salary drawn by ANALYST working in depart number 40.
SQL>select sum(sal) from emp where job='ANALYST' and deptno=40;
 
36) Display the names of the employee in order of salary i.e the name of
the employee earning lowest salary    should salary appear first.
SQL>select ename from emp order by sal;
 
37) Display the names of the employee in descending order of salary.
a)select ename from emp order by sal desc;
 
38) Display the names of the employee in order of employee name.
a)select ename from emp order by ename;
 
39) Display empno,ename,deptno,sal sort the output first base on name and
within name by deptno and with in deptno by sal.
SQL>select empno,ename,deptno,sal from emp order by
 
40) Display the name of the employee along with their annual salary(sal*12).The name of the employee earning highest annual salary should apper first.
SQL>select ename,sal*12 from emp order by sal desc;
 
41) Display name,salary,hra,pf,da,total salary for each employee. The
output should be in the order of total salary,hra 15% of salary,da 10% of salary,pf 5%
salary,total salary will be(salary+hra+da)-pf.
 
SQL>select ename,sal,sal/100*15 as hra,sal/100*5 as pf,sal/100*10 as
da, sal+sal/100*15+sal/100*10-sal/100*5 as total from emp;
 
42) Display depart numbers and total number of employees working in each
department.
SQL>select deptno,count(deptno)from emp group by deptno;
 
43) Display the various jobs and total number of employees within each job
group.
SQL>select job,count(job)from emp group by job;
 
44) Display the depart numbers and total salary for each department.
SQL>select deptno,sum(sal) from emp group by deptno;
 
 
45) Display the depart numbers and max salary for each department.
SQL>select deptno,max(sal) from emp group by deptno;
 
46) Display the various jobs and total salary for each job
SQL>select job,sum(sal) from emp group by job;
 
 
48) Display the depart numbers with more than three employees in each dept.
SQL>select deptno,count(deptno) from emp group by deptno having
count(*)>3;
 
49) Display the various jobs along with total salary for each of the jobs
where total salary is greater than 40000.
SQL>select job,sum(sal) from emp group by job having sum(sal)>40000;
 
50) Display the various jobs along with total number of employees in each
job.The output should contain only those  jobs with more than three employees.
SQL>select job,count(empno) from emp group by job having count(job)>3
 
51) Display the name of the empployee who earns highest salary.
SQL>select ename from emp where sal=(select max(sal) from emp);
 
52) Display the employee number and name for employee working as clerk and
earning highest salary among clerks.
SQL>select empno,ename from emp where where job='CLERK'
           and sal=(select max(sal) from emp  where job='CLERK');
 
53) Display the names of salesman who earns a salary more than the highest
salary of any clerk.
SQL>select ename,sal from emp where job='SALESMAN' and sal>(select
max(sal) from emp
 where job='CLERK');
 
54) Display the names of clerks who earn a salary more than the lowest
salary of any salesman.
SQL>
select ename from emp where job='CLERK' and sal>(select min(sal)
from emp where job='SALESMAN');
 
Display the names of employees who earn a salary more than that of
Jones or that of salary grether than   that of scott.
SQL>select ename,sal from emp where sal>
(select sal from emp where ename='JONES')and sal> (select sal from emp
where ename='SCOTT');
 
55) Display the names of the employees who earn highest salary in their
respective departments.
SQL>select ename,sal,deptno from emp where sal in(select max(sal) from
emp group by deptno);
 
56) Display the names of the employees who earn highest salaries in their
respective job groups.
SQL>select ename,sal,job from emp where sal in(select max(sal) from emp
group by job)
 
57) Display the employee names who are working in accounting department.
SQL>select ename from emp where deptno=(select deptno from dept where
dname='ACCOUNTING')
 
58) Display the employee names who are working in Chicago.
SQL>select ename from emp where deptno=(select deptno from dept where
LOC='CHICAGO')
 
59) Display the Job groups having total salary greater than the maximum
salary for managers.
SQL>SELECT JOB,SUM(SAL) FROM EMP GROUP BY JOB HAVING SUM(SAL)>(SELECT
MAX(SAL) FROM EMP WHERE JOB='MANAGER');
 
60) Display the names of employees from department number 10 with salary
greater than that of any employee working in other department.
SQL>select ename from emp where deptno=10 and sal>any(select sal from
emp where deptno not in 10).
 
61) Display the names of the employees from department number 10 with
salary greater than that of all employee working in other departments.
SQL>select ename from emp where deptno=10 and sal>all(select sal from
emp where deptno not in 10).
 
62) Display the names of the employees in Uppercase.
SQL>select upper(ename)from emp
 
63) Display the names of the employees in Lowecase.
SQL>select lower(ename)from emp
 
64) Display the names of the employees in Propercase.
SQL>select initcap(ename)from emp;
 
65) Display the length of Your name using appropriate function.
SQL>select length('name') from dual
 
66) Display the length of all the employee names.
SQL>select length(ename) from emp;
 
67) select name of the employee concatenate with employee number.
SQL>select ename||empno from emp;
 
68) User appropriate function and extract 3 characters starting from 2
characters from the following  string 'Oracle'. i.e the out put should be 'ac'.
SQL>select substr('oracle',3,2) from dual
 
69) Find the First occurance of character 'a' from the following string i.e
'Computer Maintenance Corporation'.
SQL>SELECT INSTR('Computer Maintenance Corporation','a',1) FROM DUAL
 
70) Replace every occurance of alphabhet A with B in the string Allens(use
translate function)
SQL>select translate('Allens','A','B') from dual
 
71) Display the informaction from emp table.Where job manager is found it
should be displayed as boos(Use replace function).
SQL>select replace(JOB,'MANAGER','BOSS') FROM EMP;
 
72) Display empno,ename,deptno from emp table.Instead of display department
numbers[B1]  display the related department name(Use decode function).
SQL>select empno,ename,decode(deptno,10,'ACCOUNTING',20,'RESEARCH',30,'SALES',40,'OPRATIONS') from emp;
 
73) Display your age in days.
SQL>select to_date(sysdate)-to_date('10-sep-77')from dual
 
74) Display your age in months.
SQL>select months_between(sysdate,'10-sep-77') from dual
 
75) Display the current date as 15th Augest Friday Nineteen Ninety Saven.
SQL>select to_char(sysdate,'ddth Month day year') from dual
 
76) Display the following output for each row from emp table.
 
scott has joined the company on wednesday 13th August ninten nintey.
SQL>select ENAME||' HAS JOINED THE COMPANY ON  '||to_char(HIREDATE,'day
ddth Month  year')   from EMP;
 
77) Find the date for nearest saturday after current date.
SQL>SELECT NEXT_DAY(SYSDATE,'SATURDAY')FROM DUAL;
 
78) Display current time.
SQL>select to_char(sysdate,'hh:MM:ss') from dual.
 
79) Display the date three months Before the current date.
SQL>select add_months(sysdate,3) from dual;
 
80) Display the common jobs from department number 10 and 20.
SQL>select job from emp where deptno=10 and job in(select job from emp
where deptno=20);
 
81) Display the jobs found in department 10 and 20 Eliminate duplicate jobs.
SQL>select distinct(job) from emp where deptno=10 or deptno=20
           (or)
SQL>select distinct(job) from emp where deptno in(10,20);
 
82) Display the jobs which are unique to department 10.
SQL>select distinct(job) from emp where deptno=10
 
83) Display the details of those who do not have any person working under them.
SQL>select e.ename from emp,emp e where emp.mgr=e.empno group by
e.ename having count(*)=1;
 
84) Display the details of those employees who are in sales department and
grade is 3.
 
SQL>select * from emp where deptno=(select deptno from dept where
dname='SALES')and sal between(select losal from salgrade where grade=3)and
             (select hisal from salgrade where grade=3);
 
85) Display those who are not managers and who are managers any one.
i)display the managers names
SQL>select distinct(m.ename) from emp e,emp m where m.empno=e.mgr;
 
ii)display the who are not managers
SQL>select ename from emp where ename not in(select distinct(m.ename)
         from emp e,emp m where m.empno=e.mgr);
 
86) Display those employee whose name contains not less than 4 characters.
SQL>select ename from emp where length(ename)>4;
 
87) Display those department whose name start with "S" while the location
name ends with "K".
SQL>select dname from dept where dname like 'S%' and loc like '%K';
 
88) Display those employees whose manager name is JONES.
SQL>select p.ename from emp e,emp p where e.empno=p.mgr and
e.ename='JONES';
 
89) Display those employees whose salary is more than 3000 after giving 20%
increment.
SQL>select ename,sal from emp where (sal+sal*.2)>3000;
 
90) Display all employees while their dept names;
SQL>select ename,dname from emp,dept where emp.deptno=dept.deptno
 
91) Display ename who are working in sales dept.
SQL>select ename from emp where deptno=(select deptno from dept where
dname='SALES');
 
92) Display employee name,deptname,salary and comm for those sal in between
2000 to 5000 while location is chicago.
SQL>select ename,dname,sal,comm from emp,dept where sal  between 2000
and 5000
          and loc='CHICAGO' and emp.deptno=dept.deptno;
 
93) Display those employees whose salary greter than his manager salary.
select p.ename from EMP e, EMP p where e.empno=p.mgr and p.sal>e.sal
 
94) Display those employees who are working in the same dept where his
manager is work.
SQL>select p.ename from emp e,emp p where e.empno=p.mgr and
p.deptno=e.deptno;
 
95) Display those employees who are not working under any manager.
SQL>select ename from emp where mgr is null
 
--96) Display grade and employees name for the dept no 10 or 30 but grade is
not 4 while joined the company before 31-dec-82.
 
SQL>select ename, grade from EMP, salgrade where Sal between losal and
Hisal and deptno     in (10, 30) and grade<>4 and hiredate<'31-DEC-82';
 
--97) Update the salary of each employee by 10% increments that are not
--Eligiblw for commission.
SQL>update emp set sal=sal+sal*10/100 where comm is null;
 
--98) SELECT that employee who joined the company before 31-dec-82 while
--Their dept location is newyork or Chicago.
 
SQL> SELECT EMPNO, ENAME, HIREDATE, DNAME, LOC FROM EMP, DEPT
 WHERE (EMP.DEPTNO=DEPT.DEPTNO) AND
HIREDATE <'31-DEC-82' AND DEPT.LOC IN ('CHICAGO','NEW YORK');
 
99) DISPLAY EMPLOYEE NAME, JOB, DEPARTMENT, LOCATION FOR ALL WHO ARE WORKING
AS MANAGER?
SQL>select ename, JOB, DNAME, LOCATION from EMP, DEPT where mgr is not Null;
 
100) DISPLAY THOSE EMPLOYEES WHOSE MANAGER NAME IS JONES? --
          [AND ALSO DISPLAY THEIR MANAGER NAME]?
 
SQL> SELECT P.ENAME FROM EMP E, EMP P WHERE E.EMPNO=P.MGR AND
E.ENAME='JONES';
 
--101) Display name and salary of ford if his salary is equal to hisal of his
Grade
 
  Select ename, sal, grade from EMP, salgrade where sal between losal and
hisal
 and ename ='FORD' AND HISAL=SAL;
 
102) Display employee name, job, depart name, manager name, his grade and make
out an under department wise?
 
SQL>SELECT E.ENAME, E.JOB, DNAME, EMP.ENAME, GRADE FROM EMP,EMP
E, SALGRADE, DEPT
WHERE EMP.SAL BETWEEN LOSAL AND HISAL AND EMP.EMPNO=E.MGR
 AND EMP.DEPTNO=DEPT.DEPTNO ORDER BY DNAME
 
103) List out all employees name,job,salary,grade and depart name for every
one in the company  except 'CLERK'.Sort on salary display the highest salary?
SQL>SELECT ENAME,JOB,DNAME,SAL,GRADE FROM EMP,SALGRADE,DEPT WHERE
SAL BETWEEN LOSAL AND HISAL AND EMP.DEPTNO=DEPT.DEPTNO AND JOB
 NOT IN('CLERK')ORDER BY SAL ASC;
 
104) Display the employee name,job and his manager.Display also employee who
are without manager?
SQL>select e.ename,e.job,eMP.ename AS Manager from emp,emp e where
emp.empno(+)=e.mgr
 
105) Find out the top 5 earners of company?
SQL>SELECT DISTINCT SAL FROM EMP E WHERE 5>=(SELECT COUNT(DISTINCT SAL)
FROM
           EMP A WHERE A.SAL>=E.SAL)ORDER BY SAL DESC;
 
 
106) Display name of those employee who are getting the highest salary?
SQL>select ename from emp where sal=(select max(sal) from emp);
 
107) Display those employee whose salary is equal to average of maximum and
minimum?
SQL>select ename from emp where sal=(select max(sal)+min(sal)/2 from
emp);
 
108) Select count of employee in each department  where count greater than 3?
SQL>select count(*) from emp group by deptno having count(deptno)>3
 
109) Display dname where at least 3 are working and display only department
name?
SQL>select distinct d.dname from dept d,emp e where d.deptno=e.deptno
and 3>any
           (select count(deptno) from emp group by deptno)
 
110) Display name of those managers name whose salary is more than average
salary of his company?
SQL>SELECT E.ENAME,EMP.ENAME FROM EMP,EMP E
           WHERE EMP.EMPNO=E.MGR AND E.SAL>(SELECT AVG(SAL) FROM EMP);
 
111)Display those managers name whose salary is more than average salary of
his employee?
SQL>SELECT DISTINCT EMP.ENAME FROM EMP,EMP E WHERE
            E.SAL <(SELECT AVG(EMP.SAL) FROM EMP
            WHERE EMP.EMPNO=E.MGR GROUP BY EMP.ENAME) AND
EMP.EMPNO=E.MGR;
 
112) Display employee name,sal,comm and net pay for those employee
whose net pay is greter than or equal to any other employee salary of
the company?
SQL>select ename,sal,comm,sal+nvl(comm,0) as NetPay from emp
          where sal+nvl(comm,0) >any (select sal from emp)
 
 
113) Display all employees names with total sal of company with each
employee name?
SQL>SELECT ENAME,(SELECT SUM(SAL)  FROM EMP) FROM EMP;
 
114) Find out last 5(least)earners of the company.?
SQL>SELECT DISTINCT SAL FROM EMP E WHERE
           5>=(SELECT COUNT(DISTINCT SAL) FROM EMP A WHERE
A.SAL<=E.SAL)
           ORDER BY SAL DESC;
 
115) Find out the number of employees whose salary is greater than their
manager salary?
SQL>SELECT E.ENAME FROM EMP ,EMP E WHERE EMP.EMPNO=E.MGR
        AND EMP.SAL<E.SAL;
 
116) Display those department where no employee working?
SQL>select dname from emp,dept where emp.deptno not in(emp.deptno)
 
117) Display those employee whose salary is ODD value?
SQL>select * from emp where sal<0;
 
118) Display those employee whose salary contains alleast 3 digits?
SQL>select * from emp where length(sal)>=3;
 
119) Display those employee who joined in the company in the month of Dec?
SQL>select ename from emp where to_char(hiredate,'MON')='DEC';
 
120) Display those employees whose name contains "A"?
SQL>select ename from emp where instr(ename,'A')>0;
                          or
SQL>select ename from emp where ename like('%A%');
 
121) Display those employee whose deptno is available in salary?
SQL>select emp.ename from emp, emp e where emp.sal=e.deptno;
 
122) Display those employee whose first 2 characters from hiredate -last 2
characters of salary?
SQL>select ename,SUBSTR(hiredate,1,2)||ENAME||substr(sal,-2,2) from emp
 
123) Display those employee whose 10% of salary is equal to the year of
joining?
SQL>select ename from emp where to_char(hiredate,'YY')=sal*0.1;
 
124) Display those employee who are working in sales or research?
SQL>SELECT ENAME FROM EMP WHERE DEPTNO IN(SELECT DEPTNO FROM DEPT WHERE
           DNAME IN('SALES','RESEARCH'));
 
125) Display the grade of jones?
SQL>SELECT ENAME,GRADE FROM EMP,SALGRADE
            WHERE SAL BETWEEN LOSAL AND HISAL AND Ename='JONES';
 
126) Display those employees who joined the company before 15 of the month?
a)select ename from emp where to_char(hiredate,'DD')<15;
 
127) Display those employee who has joined before 15th of the month.
a)select ename from emp where to_char(hiredate,'DD')<15;
 
128) Delete those records where no of employees in a particular department
is less than 3.
SQL>delete from emp where deptno=(select deptno from emp
           group by deptno having count(deptno)<3);
 
 
129) Display the name of the department where no employee working.
SQL> SELECT E.ENAME,E.JOB,M.ENAME,M.JOB FROM EMP E,EMP M
 WHERE E.MGR=M.EMPNO
 
130) Display those employees who are working as manager.
SQL>SELECT M.ENAME MANAGER FROM EMP M ,EMP E
WHERE E.MGR=M.EMPNO GROUP BY M.ENAME
 
131) Display those employees whose grade is equal to any number of sal but
not equal to first number of sal?
SQL> SELECT ENAME,GRADE FROM EMP,SALGRADE
            WHERE GRADE NOT IN(SELECT SUBSTR(SAL,0,1)FROM EMP)
 
132) Print the details of all the employees who are Sub-ordinate to BLAKE?
SQL>select emp.ename from emp, emp e where emp.mgr=e.empno and
e.ename='BLAKE';
 
 
133) Display employee name and his salary whose salary is greater than
  highest average of department number?
SQL>SELECT SAL FROM EMP WHERE SAL>(SELECT MAX(AVG(SAL)) FROM EMP
         GROUP BY DEPTNO);
 
134) Display the 10th record of emp table(without using rowid)
SQL>SELECT * FROM EMP WHERE ROWNUM<11
             MINUS
             SELECT * FROM EMP WHERE ROWNUM<10
 
135) Display the half of the ename's in upper case and remaining lowercase?
SQL>SELECT
SUBSTR(LOWER(ENAME),1,3)||SUBSTR(UPPER(ENAME),3,LENGTH(ENAME))
           FROM EMP;
 
136) Display the 10th record of emp table without using group by and rowid?
SQL>SELECT * FROM EMP WHERE ROWNUM<11
             MINUS
             SELECT * FROM EMP WHERE ROWNUM<10
 
             Delete the 10th record of emp table.
SQL>DELETE FROM EMP WHERE EMPNO=(SELECT EMPNO FROM EMP WHERE ROWNUM<11
             MINUS
             SELECT EMPNO FROM EMP WHERE ROWNUM<10)
 
137) Create a copy of emp table;
SQL>create table new_table as select * from emp where 1=2;
 
138) Select ename if ename exists more than once.
SQL>select ename  from emp e group by ename having count(*)>1;
 
139) Display all enames in reverse order?(SMITH:HTIMS).
SQL>SELECT REVERSE(ENAME)FROM EMP;
 
140) Display those employee whose joining of month and grade is equal.
SQL>SELECT ENAME FROM EMP WHERE SAL BETWEEN
           (SELECT LOSAL FROM SALGRADE WHERE
             GRADE=TO_CHAR(HIREDATE,'MM')) AND
        (SELECT HISAL FROM SALGRADE WHERE
GRADE=TO_CHAR(HIREDATE,'MM'));
            
141) Display those employee whose joining DATE is available in deptno.
SQL>SELECT ENAME FROM EMP WHERE TO_CHAR(HIREDATE,'DD')=DEPTNO
 
142) Display those employees name as follows
               A ALLEN
               B BLAKE
SQL> SELECT SUBSTR(ENAME,1,1),ENAME FROM EMP;
 
143) List out the employees ename,sal,PF(20% OF SAL) from emp;
SQL>SELECT ENAME,SAL,SAL*.2 AS PF FROM EMP;       
 
 
144) Create table emp with only one column empno;
SQL>Create table emp as select empno from emp where 1=2;
 
145) Add this column to emp table ename vrachar2(20).
SQL>alter table emp add(ename varchar2(20));
 
146) Oops I forgot give the primary key constraint.  Add in now.
SQL>alter table emp add primary key(empno);
 
147) Now increase the length of ename column to 30 characters.
SQL>alter table emp modify(ename varchar2(30));
 
148) Add salary column to emp table.
SQL>alter table emp add(sal number(10));
 
149) I want to give a validation saying that salary cannot be greater 10,000
(note give a name to this constraint)
SQL>alter table emp add constraint chk_001 check(sal<=10000)
 
150) For the time being I have decided that I will not impose this validation.My boss has agreed to pay more than 10,000.
SQL>again alter the table or drop constraint with  alter table emp drop constraint chk_001 (or)Disable the constraint by using  alter table emp modify constraint chk_001 disable;
 
151) My boss has changed his mind.  Now he doesn't want to pay more than
10,000.so revoke that salary constraint.
SQL>alter table emp modify constraint chk_001 enable;
 
152) Add column called as mgr to your emp table;
SQL>alter table emp add(mgr number(5));
 
153) Oh! This column should be related to empno.  Give a command to add this
constraint.
SQL>ALTER TABLE EMP ADD CONSTRAINT MGR_DEPT FOREIGN KEY(MGR) REFERENCES
EMP(EMPNO)
                                     
154) Add deptno column to your emp table;
SQL>alter table emp add(deptno number(5));  
 
155) This deptno column should be related to deptno column of dept table;
SQL>alter table emp add constraint dept_001 foreign key(deptno)
reference dept(deptno) 
             [deptno should be primary key]
 
156) Give the command to add the constraint.
SQL>alter table <table_name) add constraint <constraint_name>
<constraint type>
 
157) Create table called as newemp.  Using single command create this table
as well as get data into this table(use create table as);
SQL>create table newemp as select * from emp;
 
SQL>Create table called as newemp.  This table should contain only
empno,ename,dname.
SQL>create table newemp as select empno,ename,dname from emp,dept where
1=2;
 
158) Delete the rows of employees who are working in the company for more
than 2 years.
SQL>delete from emp where (sysdate-hiredate)/365>2;
 
159) Provide a commission(10% Comm Of Sal) to employees who are not earning
any commission.
SQL>select sal*0.1 from emp where comm is null
 
160) If any employee has commission his commission should be incremented by
10% of his salary.
SQL>update emp set comm=sal*.1 where comm is not null;
 
161) Display employee name and department name for each employee.
SQL>select empno,dname from emp,dept where emp.deptno=dept.deptno
 
162)Display employee number,name and location of the department in which he
is working.
SQL>select empno,ename,loc,dname from emp,dept where
emp.deptno=dept.deptno;
 
163) Display ename,dname even if there are no employees working in a
particular department(use outer join).
SQL>select ename,dname from emp,dept where emp.deptno=dept.deptno(+)
 
164) Display employee name and his manager name.
SQL>select p.ename,e.ename from emp e,emp p where e.empno=p.mgr;
 
165) Display the department name and total number of employees in each
department.
SQL>select dname,count(ename) from emp,dept where
emp.deptno=dept.deptno group by dname;
 
166)Display the department name along with total salary in each department.
SQL>select dname,sum(sal) from emp,dept where emp.deptno=dept.deptno
group by dname;
 
select * from item
167) Display itemname and total sales amount for each item.
SQL>select itemname,sum(amount) from item group by itemname;
 
168) Write a Query To Delete The Repeted Rows from emp table;
SQL>Delete from emp where rowid not in(select min(rowid)from emp group
by ename)
            
169) TO DISPLAY 5 TO 7 ROWS FROM A TABLE
select ename from emp
         where rowid in(select rowid from emp where rownum<=7
         minus
  select rowid from emp where rownum<5)
 
170)  DISPLAY  TOP N ROWS FROM TABLE?
 
SQL>SELECT * FROM
             (SELECT *  FROM EMP ORDER BY ENAME DESC)
              WHERE ROWNUM <10;
 
171) DISPLAY   TOP 3 SALARIES FROM EMP;
SQL>SELECT SAL FROM ( SELECT  * FROM EMP ORDER  BY SAL DESC )
                   WHERE ROWNUM <4
 
172) DISPLAY  9th FROM THE EMP TABLE?
SQL>SELECT ENAME FROM EMP
                     WHERE ROWID=(SELECT ROWID FROM EMP WHERE ROWNUM<=10
                     MINUS
                     SELECT ROWID FROM EMP WHERE ROWNUM <10)
                     
                     select second max salary from emp;
                     select max(sal) from emp where sal<(select  max(sal) from emp);

 



